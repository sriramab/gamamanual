<html><!-- Online page at https://github.com/gama-platform/gama/wiki/WikiOnly/Events/Event__CP12Batch --><head><meta charset="utf-8"><title>Event__CP12Batch</title><script src="../../../dash_resources/highlight.all.js"></script><link rel="stylesheet" type="text/css" href="../../../dash_resources/github-markdown.css"><link rel="stylesheet" type="text/css" href="../../../dash_resources/highlightjs.github.css"></head><body class="markdown-body" style="padding-bottom:20px; margin: 8px 13px;"><h1 id="event__cp12batch">Event__CP12Batch</h1>
<a class="dashAnchor" name="//apple_ref/Section/Batch%20Experiments"></a><h1 id="batch-experiments">Batch Experiments</h1>
<p>By the Batch People</p>
<p>Philippe Caillou,
Thomas Louail,
Nicolas Marilleau,
Huynh Quang Nghi,
Serge Stinckwich,
Patrick Taillandier,
Jean-Daniel Zucker</p>
<a class="dashAnchor" name="//apple_ref/Section/What%20do%20we%20have?"></a><h2 id="what-do-we-have">What do we have?</h2>
<p>Define an experiment, batch mode (but same capabilities as GUI mode)</p>
<p>·         Parameter exploration:  Param element</p>
<p>o   Explicit</p>
<p>o   List with step</p>
<p>·         Method Element</p>
<p>o   Exhaustive</p>
<p>o   Hill climbing</p>
<p>o   Simulated annealing</p>
<p>o   Tabu Search</p>
<p>o   Reactive Tabu Search</p>
<p>o   Genetic Algorithm</p>
<p>·         File export</p>
<p>o   File</p>
<a class="dashAnchor" name="//apple_ref/Section/How%20does%20it%20work?"></a><h2 id="how-does-it-work">How does it work?</h2>
<p>·         The experiment (the plan) creates the simulation (future: Headless mode)</p>
<a class="dashAnchor" name="//apple_ref/Section/What%20would%20be%20great%20in%20Gama%2012.4?"></a><h2 id="what-would-be-great-in-gama-124">What would be great in Gama 12.4?</h2>
<p>·         Export agent/simulation data in the file</p>
<p>o   =&gt;Define code in the experiment (loop over agents)</p>
<p>·         Put rules for variable exploration</p>
<p>o   Ex: explore b={1,2,3}. if a=2 explore b={2,3} only</p>
<p>o   How? Put code in the exploring loop =&gt; put real GAML code in the agent</p>
<p>o   =&gt; reflex "method" or "explore"</p>
<p>o   Some existing exploration actions can be used with a ParameterSet (Map?) parameter</p>
<p>·         Show plots in batch</p>
<p>o   Define output with the code/variable of the experiment agent</p>
<p>o   Require a getVariable() operator that gets the last simulation variables values</p>
<p>·         Compare agent trajectories</p>
<p>o   Stats a posteriori</p>
<p>o   (not possible inside a simulation because there is no end)</p>
<p>o   =&gt; action « aftersimulation » défined by the user</p>
<p>o   Require a getVariable() operator that gets the last simulation variables values (to be able to loop on agents)</p>
<p>·         Define more parameters/variables in the file (CSV)</p>
<p>o   =&gt; use of the Save already working</p>
<p>·         Launch parallel simulation on multicore/clusters</p>
<p>o   =&gt; special action "runSimulation" parameter to launch 4 in parallel?</p>
<p>·         "Generate" agents</p>
<p>o   Define agent parameters by using global/previous variables/files</p>
<p>o   Use of an "initSimulation" action before the "runSimulation" to  be able to change manually the simulation parameters</p>
<p>·         Définition graphique de l’espace de valeur, éventuellement en 2D et disjoint</p>
<p>o   Specific OutPut</p>
<a class="dashAnchor" name="//apple_ref/Section/The%20Solution"></a><h2 id="the-solution">The Solution</h2>
<p>Define a new <strong>Experimenter</strong> agent and put real code/reflexes/actions... GAML code inside the Experimenter.</p>
<a class="dashAnchor" name="//apple_ref/Section/One%20simple%20example%20of%20what%20would%20be%20great:"></a><h2 id="one-simple-example-of-what-would-be-great">One simple example of what would be great:</h2>
<pre><code class="hljs groovy">experiment InteliExplore <span class="hljs-string"><span class="hljs-string">type:</span></span> batch <span class="hljs-string"><span class="hljs-string">repeat:</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-string"><span class="hljs-string">keep_seed:</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-string"><span class="hljs-string">until:</span></span> ( time &gt; <span class="hljs-number"><span class="hljs-number">200</span></span> ) {
      <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> nbprey <span class="hljs-string"><span class="hljs-string">init:</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>;
      <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> nbpredator <span class="hljs-string"><span class="hljs-string">init:</span></span><span class="hljs-number"><span class="hljs-number">0</span></span>;

      init
      {
            <span class="hljs-comment"><span class="hljs-comment">//for example read experiment plan from file</span></span>
           
      }
     

      reflex method
      {
            loop prm <span class="hljs-string"><span class="hljs-string">over:</span></span>prey_max
            {
<span class="hljs-symbol"><span class="hljs-symbol">                   do:</span></span> createsimulation
                   setParameter(<span class="hljs-string"><span class="hljs-string">"nb_preys_init"</span></span>,pr)
<span class="hljs-symbol"><span class="hljs-symbol">
                   do:</span></span> initsimulation

                   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (prey_max&lt;<span class="hljs-number"><span class="hljs-number">100</span></span>)
                   setParameter(<span class="hljs-string"><span class="hljs-string">"nb_predators_init"</span></span>,<span class="hljs-number"><span class="hljs-number">200</span></span>)
                   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (prey_max&gt;<span class="hljs-number"><span class="hljs-number">100</span></span>)
                   setParameter(<span class="hljs-string"><span class="hljs-string">"nb_predators_init"</span></span>,<span class="hljs-number"><span class="hljs-number">200</span></span>)
<span class="hljs-symbol"><span class="hljs-symbol">
                   do:</span></span> runsimulation;
<span class="hljs-symbol"><span class="hljs-symbol">
                   do:</span></span> aftersimulation;
                  
            }
      }

      action aftersimulation
      {
            loop over getVariable(agents)
            {
                   log(<span class="hljs-string"><span class="hljs-string">"everything dans file"</span></span>);      <span class="hljs-comment"><span class="hljs-comment">//with the save function?</span></span>
            }     
      }

      chart <span class="hljs-string"><span class="hljs-string">name:</span></span> <span class="hljs-string"><span class="hljs-string">'Species evolution'</span></span> <span class="hljs-string"><span class="hljs-string">type:</span></span> series <span class="hljs-string"><span class="hljs-string">background:</span></span> rgb(<span class="hljs-string"><span class="hljs-string">'white'</span></span>) <span class="hljs-string"><span class="hljs-string">size:</span></span> {<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">0.4</span></span>} <span class="hljs-string"><span class="hljs-string">position:</span></span> {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0.05</span></span>}
      {
      data initial_number_of_preys <span class="hljs-string"><span class="hljs-string">value:</span></span> getValue(<span class="hljs-string"><span class="hljs-string">"nb_preys_init"</span></span>) <span class="hljs-string"><span class="hljs-string">color:</span></span> rgb(<span class="hljs-string"><span class="hljs-string">'blue'</span></span>) ;
        data final_number_of_predator <span class="hljs-string"><span class="hljs-string">value:</span></span> getValue(<span class="hljs-string"><span class="hljs-string">"nb_predators"</span></span>) <span class="hljs-string"><span class="hljs-string">color:</span></span> rgb(<span class="hljs-string"><span class="hljs-string">'red'</span></span>) ;
      }
    file <span class="hljs-string"><span class="hljs-string">name:</span></span> <span class="hljs-string"><span class="hljs-string">'logsimple'</span></span> <span class="hljs-string"><span class="hljs-string">type:</span></span> text <span class="hljs-string"><span class="hljs-string">data:</span></span> <span class="hljs-string"><span class="hljs-string">'simulation: '</span></span>+ step
                                  +<span class="hljs-string"><span class="hljs-string">'; allparams'</span></span> + getAllParamters <span class="hljs-comment"><span class="hljs-comment">// PROBLEME comment sauver tous les parametres?</span></span>
                                   + <span class="hljs-string"><span class="hljs-string">'; nbPreys: '</span></span> + getValue(<span class="hljs-string"><span class="hljs-string">"nb_preys_init"</span></span>)
                                    + <span class="hljs-string"><span class="hljs-string">'; finalPredators: '</span></span> + getValue(<span class="hljs-string"><span class="hljs-string">"nb_preys"</span></span>) ;
}
</code></pre>
<a class="dashAnchor" name="//apple_ref/Section/TODO"></a><h2 id="todo">TODO</h2>
<p>And Alexis did almost all this in less than a day....... But how does he do that??</p>
<ul>
<li><p>A new type of Custom Experiment</p>
</li>
<li><p>In this experiment block, an ExperimenterAgent manages the simulations</p>
</li>
<li><p>Init() may have to create a Simulation to get a Scheduler (?) and/or a World(?)</p>
</li>
<li><p>He must have a Scheduler to be able to stop/wait in a loop for the end of a Simulation (contradiction with previous point...)</p>
</li>
<li><p>Its most important function is to be able to call Simulation.step()</p>
</li>
</ul>
<p>=&gt;Create a Simulation Type which has a Step() operator</p>
<ul>
<li><p>Create a ExperimentatorSkill with a lot of usefull actions (Step(int), ...)</p>
</li>
<li><p>Check that it is possible to define plots, logs, ...</p>
</li>
</ul>
<script>hljs.initHighlightingOnLoad();</script></body></html>