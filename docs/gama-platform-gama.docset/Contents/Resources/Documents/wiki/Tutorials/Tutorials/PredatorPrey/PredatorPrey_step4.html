<html><!-- Online page at https://github.com/gama-platform/gama/wiki/Tutorials/Tutorials/PredatorPrey/PredatorPrey_step4 --><head><meta charset="utf-8"><title>PredatorPrey_step4</title><script src="../../../../dash_resources/highlight.all.js"></script><link rel="stylesheet" type="text/css" href="../../../../dash_resources/github-markdown.css"><link rel="stylesheet" type="text/css" href="../../../../dash_resources/highlightjs.github.css"></head><body class="markdown-body" style="padding-bottom:20px; margin: 8px 13px;"><h1 id="predatorprey_step4">PredatorPrey_step4</h1>
<a class="dashAnchor" name="//apple_ref/Section/4.%20Inspectors%20and%20Monitors"></a><h1 id="4-inspectors-and-monitors">4. Inspectors and Monitors</h1>
<p>This fourth step Illustrates how to monitor more precisely the simulation. Practically, we will define monitors to follow the evolution of specific variables (or expression) whereas inspector allows to follow the state of a given agent (or a species).</p>
<table><thead><tr></tr></thead><tbody><tr></tr><tr></tr><tr></tr></tbody></table><a class="dashAnchor" name="//apple_ref/Section/Formulation"></a><h2 id="formulation">Formulation</h2>
<ul>
<li>Adding of a monitor to follow the evolution of the number of prey agents</li>
</ul>
<table><thead><tr></tr></thead><tbody><tr></tr><tr></tr><tr></tr></tbody></table><a class="dashAnchor" name="//apple_ref/Section/Model%20Definition"></a><h2 id="model-definition">Model Definition</h2>
<a class="dashAnchor" name="//apple_ref/Section/global%20variable"></a><h3 id="global-variable">global variable</h3>
<p>We add a new global variable:</p>
<ul>
<li><strong>nb_preys</strong> : returns, each time it is called, the current number of (live) prey agents</li>
</ul>
<p>To do so we use the <strong>-&gt;{expression}</strong> facet which returns the value of <strong>expression</strong>, each time it is called..
We use as well the operator <strong>length</strong> that returns the number of elements in a list.</p>
<p>Thus, In the global section, we add the <strong>nb_preys</strong> global variable:</p>
<pre><code class="hljs rust">   <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> nb_preys -&gt; {length (prey)};
</code></pre>
<a class="dashAnchor" name="//apple_ref/Section/monitor"></a><h3 id="monitor">monitor</h3>
<p>A monitor allows to follow the value of an arbitrary expression in GAML. It has to be defined in an output section. A monitor is defined as follows:</p>
<pre><code class="hljs smali">     <span class="hljs-built_in"><span class="hljs-built_in"> monitor </span></span>monitor_name value: an_expression refresh:every(nb_steps);
</code></pre>
<p>With:</p>
<ul>
<li>value: mandatory, its that value will be displayed in the monitor.
<ul>
<li>refresh: bool, optional : if the expression is true, compute (default is true).</li>
</ul>
</li>
</ul>
<p>In this model, we define a monitor to follow the value of the variable <strong>nb_preys</strong>:</p>
<pre><code class="hljs smali">     <span class="hljs-built_in"><span class="hljs-built_in"> monitor </span></span><span class="hljs-string"><span class="hljs-string">"number of preys"</span></span> value: nb_preys;
</code></pre>
<a class="dashAnchor" name="//apple_ref/Section/inspector"></a><h3 id="inspector">inspector</h3>
<p>Inspectors allow to obtain informations about a species or an agent. There are two kinds of agent information features:</p>
<ul>
<li>Species browser: provides informations about all the agents of a species. Available in the Agents menu.</li>
</ul>
<p><img src="../../../../github.com/wiki/gama-platform/gama/Tutorials/Tutorials/PredatorPrey/resources/images/tutorials/browser_table.png" alt="images/browser_table.png"></p>
<ul>
<li>Agent inspector: provides information about one specific agent. Also allows to change the values of its variables during the simulation. Available from the Agents menu, by right_clicking on a display, in the species inspector or when inspecting another agent. It provides also the possibility to «highlight» the inspected agent.</li>
</ul>
<p><img src="../../../../github.com/wiki/gama-platform/gama/Tutorials/Tutorials/PredatorPrey/resources/images/tutorials/inspector.png" alt="images/inspector.png"></p>
<table><thead><tr></tr></thead><tbody><tr></tr><tr></tr></tbody></table><a class="dashAnchor" name="//apple_ref/Section/Complete%20Model"></a><h2 id="complete-model">Complete Model</h2>
<pre><code class="hljs mel">model prey_predator

<span class="hljs-keyword"><span class="hljs-keyword">global</span></span> {
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> nb_preys_init &lt;- <span class="hljs-number"><span class="hljs-number">200</span></span> ;
    <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> prey_max_energy &lt;- <span class="hljs-number"><span class="hljs-number">1.0</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> prey_max_transfert &lt;- <span class="hljs-number"><span class="hljs-number">0.1</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> prey_energy_consum &lt;- <span class="hljs-number"><span class="hljs-number">0.05</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> nb_preys -&gt; {length (prey)};
    
    init {
        create prey number: nb_preys_init ;
    }
}
species prey {
    <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> <span class="hljs-keyword"><span class="hljs-keyword">size</span></span> &lt;- <span class="hljs-number"><span class="hljs-number">1.0</span></span> ;
    rgb <span class="hljs-keyword"><span class="hljs-keyword">color</span></span> &lt;- #blue;
    <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> max_energy &lt;- prey_max_energy ;
    <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> max_transfert &lt;- prey_max_transfert ;
    <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> energy_consum &lt;- prey_energy_consum ;
        
    vegetation_cell myCell &lt;- one_of (vegetation_cell) ; 
    <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> energy &lt;- (rnd(<span class="hljs-number"><span class="hljs-number">1000</span></span>) / <span class="hljs-number"><span class="hljs-number">1000</span></span>) * max_energy  update: energy - energy_consum <span class="hljs-keyword"><span class="hljs-keyword">max</span></span>: max_energy ;
        
    init { 
        location &lt;- myCell.location;
    }
        
    reflex basic_move { 
        myCell &lt;- one_of (myCell.neighbours) ;
        location &lt;- myCell.location ;
    }
    reflex eat when: myCell.food &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> { 
        <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> energy_transfert &lt;- <span class="hljs-keyword"><span class="hljs-keyword">min</span></span>([max_transfert, myCell.food]) ;
        myCell.food &lt;- myCell.food - energy_transfert ;
        energy &lt;- energy + energy_transfert ;
    }
    reflex die when: energy &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span> {
        <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> die ;
    }

    aspect base {
        draw <span class="hljs-keyword"><span class="hljs-keyword">circle</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">size</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">color</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">color</span></span> ;
    }
}

<span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> vegetation_cell width: <span class="hljs-number"><span class="hljs-number">50</span></span> height: <span class="hljs-number"><span class="hljs-number">50</span></span> neighbours: <span class="hljs-number"><span class="hljs-number">4</span></span> {
    <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> maxFood &lt;- <span class="hljs-number"><span class="hljs-number">1.0</span></span> ;
    <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> foodProd &lt;- (rnd(<span class="hljs-number"><span class="hljs-number">1000</span></span>) / <span class="hljs-number"><span class="hljs-number">1000</span></span>) * <span class="hljs-number"><span class="hljs-number">0.01</span></span> ;
    <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> food &lt;- (rnd(<span class="hljs-number"><span class="hljs-number">1000</span></span>) / <span class="hljs-number"><span class="hljs-number">1000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">max</span></span>: maxFood update: food + foodProd ;
    rgb <span class="hljs-keyword"><span class="hljs-keyword">color</span></span> &lt;- rgb(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span> * (<span class="hljs-number"><span class="hljs-number">1</span></span> - food)), <span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span> * (<span class="hljs-number"><span class="hljs-number">1</span></span> - food))) update: rgb(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span> * (<span class="hljs-number"><span class="hljs-number">1</span></span> - food)), <span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span> *(<span class="hljs-number"><span class="hljs-number">1</span></span> - food))) ;
    list&lt;vegetation_cell&gt; neighbours  &lt;- (self neighbours_at <span class="hljs-number"><span class="hljs-number">2</span></span>);
}

experiment prey_predator type: gui {
    parameter <span class="hljs-string"><span class="hljs-string">"Initial number of preys: "</span></span> var: nb_preys_init <span class="hljs-keyword"><span class="hljs-keyword">min</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">max</span></span>: <span class="hljs-number"><span class="hljs-number">1000</span></span> category: <span class="hljs-string"><span class="hljs-string">"Prey"</span></span> ;
    parameter <span class="hljs-string"><span class="hljs-string">"Prey max energy: "</span></span> var: prey_max_energy category: <span class="hljs-string"><span class="hljs-string">"Prey"</span></span> ;
    parameter <span class="hljs-string"><span class="hljs-string">"Prey max transfert: "</span></span> var: prey_max_transfert  category: <span class="hljs-string"><span class="hljs-string">"Prey"</span></span> ;
    parameter <span class="hljs-string"><span class="hljs-string">"Prey energy consumption: "</span></span> var: prey_energy_consum  category: <span class="hljs-string"><span class="hljs-string">"Prey"</span></span> ;
    output {
        display main_display {
            <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> vegetation_cell lines: #black ;
            species prey aspect: base ;
        }
        monitor <span class="hljs-string"><span class="hljs-string">"Number of preys"</span></span> value: nb_preys ;
    }
}
</code></pre>
<script>hljs.initHighlightingOnLoad();</script></body></html>