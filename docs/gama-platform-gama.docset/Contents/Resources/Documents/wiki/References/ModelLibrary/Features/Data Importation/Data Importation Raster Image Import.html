<html><!-- Online page at https://github.com/gama-platform/gama/wiki/References/ModelLibrary/Features/Data Importation/Data Importation Raster Image Import --><head><meta charset="utf-8"><title>Data Importation Raster Image Import</title><script src="../../../../../dash_resources/highlight.all.js"></script><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/github-markdown.css"><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/highlightjs.github.css"></head><body class="markdown-body" style="padding-bottom:20px; margin: 8px 13px;"><h1 id="data-importation-raster-image-import">Data Importation Raster Image Import</h1>
<h1 id="raster-file-in-a-grid-of-cells">Raster File in a Grid of cells</h1>
<p><em>Author : Maroussia Vavasseur and Benoit Gaudou</em></p>
<p>Model which shows how to import a Raster file in GAMA and use it to initialize the color attributes of a grid of cells. This model represents a grid with a cell, each cell has a color, and this color is used for animals (izards) to be placed on a cell that verifies some conditions. The izards do not move once they have been placed. </p>
<p>Code of the model : </p>
<pre><code class="hljs processing">
model HowToImportRaster

global {    
    <span class="hljs-comment">// Constants </span>
    <span class="hljs-built_in">int</span> heightImg <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- <span class="hljs-number">5587</span>;
    <span class="hljs-built_in">int</span> widthImg <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- <span class="hljs-number">6201</span>;    
      
    <span class="hljs-comment">// Global variables</span>
    <span class="hljs-built_in">int</span> factorDiscret &lt;- <span class="hljs-number">30</span> ;
    file mntImageRaster &lt;- image_file(<span class="hljs-string">'../images/mnt/testAG.jpg'</span>) ;
    
    <span class="hljs-built_in">int</span> nbIzard &lt;- <span class="hljs-number">250</span> ; 
    file izardShape &lt;- file(<span class="hljs-string">'../images/icons/izard.gif'</span>);
            
    <span class="hljs-comment">// Initialization of grid and creation of the izard agents</span>
    <span class="hljs-comment">// - we use the as_matrix operator to transform a image file into a matrix of colors </span>
    <span class="hljs-comment">// (Note that as_matrix takes a Point as right operand, this point specifies the number of lines and columns of the matrix)</span>
    <span class="hljs-comment">// - we then set the color built-in attribute of the cell with the value of the corresponding matrix cell     </span>
    init {
        <span class="hljs-comment">// set mapColor value: mntImageRaster as_matrix {widthImg/factorDiscret,heightImg/factorDiscret} ;</span>
        ask cell {      
            <span class="hljs-built_in">color</span> &lt;-rgb( (mntImageRaster) at {grid_x,grid_y}) ;
        }
        create izard number: nbIzard; 
    }
}
 

<span class="hljs-comment">// We create izard agents and locate them on one'cell' among the list of cellules in which there is no izard </span>
<span class="hljs-comment">// and with a color that is not white 'each.color != #white'</span>
<span class="hljs-comment">// the shuffle operator is used to randomized the list of cells</span>


species izard { 
    init{
        location &lt;- (shuffle(cell) first_with ((each.<span class="hljs-built_in">color</span> != #white) and (empty(izard inside each)))).location ;
    }       
    aspect <span class="hljs-keyword">default</span>{
        <span class="hljs-title">draw</span> square(<span class="hljs-number">1</span>) <span class="hljs-built_in">color</span>: #orange;
    }
    aspect <span class="hljs-built_in">image</span>{
        <span class="hljs-title">draw</span> izardShape <span class="hljs-built_in">size</span>: <span class="hljs-number">3</span>;
    }
}

<span class="hljs-comment">// We create a grid as environment with the same dimensions as the matrix in which we want to store the image</span>
<span class="hljs-comment">// Note that the height (resp. the width) of the grid corresponds to the number of rows (resp. of columns) of the matrix:</span>
<span class="hljs-comment">// - in the creation of a matrix: ([...] as_matrix {widthImg/factorDiscret,heightImg/factorDiscret} ;)</span>
<span class="hljs-comment">// - in the creation of the grid: grid cellule width: widthImg/factorDiscret height: heightImg/factorDiscret;</span>

grid cell  <span class="hljs-built_in">width</span>: widthImg/factorDiscret <span class="hljs-built_in">height</span>: heightImg/factorDiscret;



experiment main type: gui { 
    <span class="hljs-comment">// We display:</span>
    <span class="hljs-comment">// - the grid</span>
    <span class="hljs-comment">// - the original MNT image as background</span>
    <span class="hljs-comment">// - izard agents</span>
    <span class="hljs-comment">// We can thus compare the original MNT image and the discretized image in the grid.</span>
    <span class="hljs-comment">// For cosmetic need, we can choose to not display the grid. </span>
    output {
        display HowToImportRaster {
           grid cell;
           <span class="hljs-built_in">image</span> <span class="hljs-string">'Background'</span> file: mntImageRaster.path;
           species izard aspect: <span class="hljs-built_in">image</span>; 
        }   
    }   
}
</code></pre>
<script>hljs.initHighlightingOnLoad();</script></body></html>