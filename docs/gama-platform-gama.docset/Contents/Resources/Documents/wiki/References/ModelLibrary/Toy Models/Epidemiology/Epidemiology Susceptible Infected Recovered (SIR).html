<html><!-- Online page at https://github.com/gama-platform/gama/wiki/References/ModelLibrary/Toy Models/Epidemiology/Epidemiology Susceptible Infected Recovered (SIR) --><head><meta charset="utf-8"><title>Epidemiology Susceptible Infected Recovered (SIR)</title><script src="../../../../../dash_resources/highlight.all.js"></script><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/github-markdown.css"><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/highlightjs.github.css"></head><body class="markdown-body" style="padding-bottom:20px; margin: 8px 13px;"><h1 id="epidemiology-susceptible-infected-recovered-sir">Epidemiology Susceptible Infected Recovered (SIR)</h1>
<h1 id="sir-without-ode">SIR without ODE</h1>
<p>_Author : _</p>
<p>A simple SIR model without Ordinary Differential Equations showing agents moving randomly among a grid and becoming infected then resistant to a disease</p>
<p>Code of the model : </p>
<pre><code class="hljs cs">
model si

global { 
    <span class="hljs-comment">//Number of susceptible host at init</span>
    <span class="hljs-keyword">int</span> number_S &lt;- <span class="hljs-number">495</span>;
    <span class="hljs-comment">//Number of infected host at init</span>
    <span class="hljs-keyword">int</span> number_I &lt;- <span class="hljs-number">5</span> ;
    <span class="hljs-comment">//Number of resistant host at init</span>
    <span class="hljs-keyword">int</span> number_R &lt;- <span class="hljs-number">0</span> ;
    <span class="hljs-comment">//Rate for the infection success </span>
    <span class="hljs-keyword">float</span> beta &lt;- <span class="hljs-number">0.05</span> ;
    <span class="hljs-comment">//Mortality rate for the host</span>
    <span class="hljs-keyword">float</span> nu &lt;- <span class="hljs-number">0.001</span> ;
    <span class="hljs-comment">//Rate for resistance </span>
    <span class="hljs-keyword">float</span> delta &lt;- <span class="hljs-number">0.01</span>;
    <span class="hljs-comment">//Number total of hosts</span>
    <span class="hljs-keyword">int</span> numberHosts &lt;- number_S+number_I+number_R;
    <span class="hljs-comment">//Boolean to represent if the infection is computed locally</span>
    <span class="hljs-keyword">bool</span> local_infection &lt;- <span class="hljs-literal">true</span> parameter: <span class="hljs-string">"Is the infection is computed locally?"</span>;
    <span class="hljs-comment">//Range of the cells considered as neighbours for a cell</span>
    <span class="hljs-keyword">int</span> neighbours_size &lt;- <span class="hljs-number">2</span> min:<span class="hljs-number">1</span> max: <span class="hljs-number">5</span> parameter:<span class="hljs-string">"Size of the neighbours"</span>;
    
    <span class="hljs-keyword">float</span> R0 ;
    geometry shape &lt;- square(<span class="hljs-number">50</span>);
    
    init {
        <span class="hljs-comment">//Creation of all the susceptible Host</span>
        create Host number: number_S {
            is_susceptible &lt;- <span class="hljs-literal">true</span>;
            is_infected &lt;-  <span class="hljs-literal">false</span>;
            is_immune &lt;-  <span class="hljs-literal">false</span>; 
            color &lt;-  <span class="hljs-meta">#green;</span>
        }
        <span class="hljs-comment">//Creation of all the infected Host</span>
        create Host number: number_I {
            is_susceptible &lt;-  <span class="hljs-literal">false</span>;
            is_infected &lt;-  <span class="hljs-literal">true</span>;
            is_immune &lt;-  <span class="hljs-literal">false</span>; 
            color &lt;-  <span class="hljs-meta">#red; </span>
       }
       <span class="hljs-comment">//Creation of all the resistant Host</span>
       create Host number: number_R {
            is_susceptible &lt;-  <span class="hljs-literal">false</span>;
            is_infected &lt;-  <span class="hljs-literal">false</span>;
            is_immune &lt;-  <span class="hljs-literal">true</span>; 
            color &lt;-  <span class="hljs-meta">#blue; </span>
       }
       
       
       R0 &lt;- beta/(delta+nu);
        write <span class="hljs-string">"Basic Reproduction Number: "</span>+ R0;
   }
   
   <span class="hljs-comment">//Reflex to update the number of infected</span>
   reflex compute_nb_infected {
        number_I &lt;- <span class="hljs-function">Host <span class="hljs-title">count</span> (<span class="hljs-params">each.is_infected</span>)</span>;
   }       
}


<span class="hljs-comment">//Grid used to discretize space </span>
grid sir_grid width: <span class="hljs-number">50</span> height: <span class="hljs-number">50</span> use_individual_shapes: <span class="hljs-literal">false</span> use_regular_agents: <span class="hljs-literal">false</span> frequency: <span class="hljs-number">0</span>{
    rgb color &lt;- <span class="hljs-meta">#black;</span>
    list&lt;sir_grid&gt; neighbours &lt;- (self neighbors_at neighbours_size) ;       
}

<span class="hljs-comment">//Species host which represent the Host of the disease</span>
species Host  {
    <span class="hljs-comment">//Booleans to represent the state of the host agent</span>
    <span class="hljs-keyword">bool</span> is_susceptible &lt;- <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">bool</span> is_infected &lt;- <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">bool</span> is_immune &lt;- <span class="hljs-literal">false</span>;
    rgb color &lt;- <span class="hljs-meta">#green;</span>
    sir_grid myPlace;
    
    init {
        <span class="hljs-comment">//Place the agent randomly among the grid</span>
        myPlace &lt;- one_of (sir_grid <span class="hljs-keyword">as</span> list);
        location &lt;- myPlace.location;
    }     
    <span class="hljs-comment">//Reflex to make the agent move   </span>
    reflex basic_move {
        myPlace &lt;- one_of (myPlace.neighbours) ;
        location &lt;- myPlace.location;
    }
    <span class="hljs-comment">//Reflex to make the agent infected if it is susceptible</span>
    reflex become_infected <span class="hljs-keyword">when</span>: is_susceptible {
        <span class="hljs-keyword">float</span> rate  &lt;- <span class="hljs-number">0.0</span>;
        <span class="hljs-comment">//computation of the infection according to the possibility of the disease to spread locally or not</span>
        <span class="hljs-keyword">if</span>(local_infection) {
            <span class="hljs-keyword">int</span> nb_hosts  &lt;- <span class="hljs-number">0</span>;
            <span class="hljs-keyword">int</span> nb_hosts_infected  &lt;- <span class="hljs-number">0</span>;
            loop hst over: ((myPlace.neighbours + myPlace) accumulate (Host overlapping each)) {
                nb_hosts &lt;- nb_hosts + <span class="hljs-number">1</span>;
                <span class="hljs-keyword">if</span> (hst.is_infected) {nb_hosts_infected &lt;- nb_hosts_infected + <span class="hljs-number">1</span>;}
            }
            rate &lt;- nb_hosts_infected / nb_hosts;
        } <span class="hljs-keyword">else</span> {
            rate &lt;- number_I / numberHosts;
        }
        <span class="hljs-keyword">if</span> (flip(beta * rate)) {
            is_susceptible &lt;-  <span class="hljs-literal">false</span>;
            is_infected &lt;-  <span class="hljs-literal">true</span>;
            is_immune &lt;-  <span class="hljs-literal">false</span>;
            color &lt;-  <span class="hljs-meta">#red;    </span>
        }
    }
    <span class="hljs-comment">//Reflex to make the agent recovered if it is infected and if it success the probability</span>
    reflex become_immune <span class="hljs-keyword">when</span>: (<span class="hljs-function">is_infected and <span class="hljs-title">flip</span>(<span class="hljs-params">delta</span>)) </span>{
        is_susceptible &lt;- <span class="hljs-literal">false</span>;
        is_infected &lt;- <span class="hljs-literal">false</span>;
        is_immune &lt;- <span class="hljs-literal">true</span>;
        color &lt;- <span class="hljs-meta">#blue;</span>
    }
    <span class="hljs-comment">//Reflex to kill the agent according to the probability of dying</span>
    reflex shallDie <span class="hljs-keyword">when</span>: flip(nu) {
        <span class="hljs-comment">//Create another agent</span>
        <span class="hljs-function">create <span class="hljs-title">species</span>(<span class="hljs-params">self</span>)  </span>{
            myPlace &lt;- myself.myPlace ;
            location &lt;- myself.location ; 
        }
        <span class="hljs-keyword">do</span> die;
    }
            
    aspect basic {
        <span class="hljs-function">draw <span class="hljs-title">circle</span>(<span class="hljs-params"><span class="hljs-number">1</span></span>) color: color</span>; 
    }
}


experiment Simulation type: gui { 
    parameter <span class="hljs-string">"Number of Susceptible"</span> <span class="hljs-keyword">var</span>: number_S ;<span class="hljs-comment">// The number of susceptible</span>
    parameter <span class="hljs-string">"Number of Infected"</span> <span class="hljs-keyword">var</span>: number_I ;  <span class="hljs-comment">// The number of infected</span>
    parameter <span class="hljs-string">"Number of Resistant"</span> <span class="hljs-keyword">var</span>:number_R ;  <span class="hljs-comment">// The number of removed</span>
    parameter <span class="hljs-string">"Beta (S-&gt;I)"</span> <span class="hljs-keyword">var</span>:beta;   <span class="hljs-comment">// The parameter Beta</span>
    parameter <span class="hljs-string">"Mortality"</span> <span class="hljs-keyword">var</span>:nu ;  <span class="hljs-comment">// The parameter Nu</span>
    parameter <span class="hljs-string">"Delta (I-&gt;R)"</span> <span class="hljs-keyword">var</span>: delta; <span class="hljs-comment">// The parameter Delta</span>
    parameter <span class="hljs-string">"Is the infection is computed locally?"</span> <span class="hljs-keyword">var</span>:local_infection ;
    parameter <span class="hljs-string">"Size of the neighbours"</span> <span class="hljs-keyword">var</span>:neighbours_size ;
    output { 
        display sir_display {
            grid sir_grid lines: <span class="hljs-meta">#black;</span>
            species Host aspect: basic;
        }
            
        display chart refresh: every(<span class="hljs-number">10</span>) {
            chart <span class="hljs-string">"Susceptible"</span> type: series background: <span class="hljs-meta">#lightgray style: exploded {</span>
                data <span class="hljs-string">"susceptible"</span> <span class="hljs-keyword">value</span>: <span class="hljs-function">Host <span class="hljs-title">count</span> (<span class="hljs-params">each.is_susceptible</span>) color: #green</span>;
                data <span class="hljs-string">"infected"</span> <span class="hljs-keyword">value</span>: <span class="hljs-function">Host <span class="hljs-title">count</span> (<span class="hljs-params">each.is_infected</span>) color: #red</span>;
                data <span class="hljs-string">"immune"</span> <span class="hljs-keyword">value</span>: <span class="hljs-function">Host <span class="hljs-title">count</span> (<span class="hljs-params">each.is_immune</span>) color: #blue</span>;
            }
        }
            
    }
}
</code></pre>
<script>hljs.initHighlightingOnLoad();</script></body></html>