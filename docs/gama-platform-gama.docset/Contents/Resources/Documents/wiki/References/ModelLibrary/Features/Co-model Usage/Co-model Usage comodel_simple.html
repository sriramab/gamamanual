<html><!-- Online page at https://github.com/gama-platform/gama/wiki/References/ModelLibrary/Features/Co-model Usage/Co-model Usage comodel_simple --><head><meta charset="utf-8"><title>Co model Usage comodel_simple</title><script src="../../../../../dash_resources/highlight.all.js"></script><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/github-markdown.css"><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/highlightjs.github.css"></head><body class="markdown-body" style="padding-bottom:20px; margin: 8px 13px;"><h1 id="co-model-usage-comodel_simple">Co model Usage comodel_simple</h1>
<h1 id="simple-syntax-demonstration-of-comodeling">Simple syntax demonstration of Comodeling</h1>
<p><em>Author : HUYNH Quang Nghi</em></p>
<p>This is a simple comodel serve to demonstrate the importation and instatiation of micro-model without using the couplings  </p>
<p>Imported models : </p>
<pre><code class="hljs nginx"><span class="hljs-attribute">model</span> M2


global
{
    <span class="hljs-attribute">int</span> n &lt;- <span class="hljs-number">4</span>;
    <span class="hljs-section">init</span>
    {
        <span class="hljs-attribute">create</span> B number: n;
    }

}

<span class="hljs-attribute">species</span> B skills: [moving]
{
    <span class="hljs-attribute">int</span> IQ &lt;- rnd(<span class="hljs-number">100</span>);
    <span class="hljs-attribute">reflex</span> dolive
    {
        <span class="hljs-attribute">write</span> <span class="hljs-string">""</span> + <span class="hljs-string">"i'm alive !!"</span>;
        <span class="hljs-attribute">do</span> wander;
    }

    <span class="hljs-attribute">aspect</span> default
    {
        <span class="hljs-attribute">draw</span> square(<span class="hljs-number">1</span>) color: <span class="hljs-comment"># red;</span>
    }

}

experiment M2_exp type: gui
{
    <span class="hljs-section">output</span>
    {
        <span class="hljs-attribute">display</span> <span class="hljs-string">"m2_disp"</span>
        {
            <span class="hljs-attribute">species</span> B aspect: default;
        }

    }

}

</code></pre>
<pre><code class="hljs nginx"><span class="hljs-attribute">model</span> M1


global
{
    <span class="hljs-attribute">int</span> n &lt;- <span class="hljs-number">8</span>;
    <span class="hljs-section">init</span>
    {
        <span class="hljs-attribute">create</span> A number: n;
    }

}

<span class="hljs-attribute">species</span> A skills: [moving]
{
    <span class="hljs-attribute">int</span> IQ &lt;- rnd(<span class="hljs-number">100</span>);
    <span class="hljs-attribute">reflex</span> dolive
    {
        <span class="hljs-attribute">write</span> <span class="hljs-string">""</span> + <span class="hljs-string">"i'm alive !!"</span>;
        <span class="hljs-attribute">do</span> wander;
    }

    <span class="hljs-attribute">aspect</span> default
    {
        <span class="hljs-attribute">draw</span> square(<span class="hljs-number">1</span>) color: <span class="hljs-comment"># green;</span>
    }

}

experiment M1_exp type: gui
{
    <span class="hljs-section">output</span>
    {
        <span class="hljs-attribute">display</span> <span class="hljs-string">"m1_disp"</span>
        {
            <span class="hljs-attribute">species</span> A aspect: default;
        }

    }

}

</code></pre>
<p>Code of the model : </p>
<pre><code class="hljs gradle">model Comodel_simple

<span class="hljs-keyword">import</span> <span class="hljs-string">"m1.gaml"</span> as micro_model_1
<span class="hljs-keyword">import</span> <span class="hljs-string">"m2.gaml"</span> as micro_model_2


global
{
    init
    {
    <span class="hljs-comment">//micro_model must be instantiated by create statement. We create an experiment inside the micro-model and the simulation will be created implicitly (1 experiment have only 1 simulation).</span>
        create micro_model_1.M1_exp number: <span class="hljs-number">5</span>;
        create micro_model_2.M2_exp;
    }

    reflex simulate_micro_models
    {

    <span class="hljs-comment">//tell the first experiment of micro_model_1 do 1 step;</span>
        ask first(micro_model_1.M1_exp).simulation
        {
            <span class="hljs-keyword">do</span> _step_;
        }

        <span class="hljs-comment">//tell the  experiment at 3 of micro_model_1 do 1 step;</span>
        ask (micro_model_1.M1_exp at <span class="hljs-number">3</span>).simulation
        {
            <span class="hljs-keyword">do</span> _step_;
        }

        <span class="hljs-comment">//tell all experiments of micro_model_1 do 1 step;</span>
        ask (micro_model_1.M1_exp <span class="hljs-keyword">collect</span> <span class="hljs-keyword">each</span>.simulation)
        {
            <span class="hljs-keyword">do</span> _step_;
        }

        <span class="hljs-comment">//tell all experiments of micro_model_2 do 1 step;</span>
        ask (micro_model_2.M2_exp <span class="hljs-keyword">collect</span> <span class="hljs-keyword">each</span>.simulation)
        {
            <span class="hljs-keyword">do</span> _step_;
        }
        
        <span class="hljs-comment">//kill simulation  of micro_model and recreate then</span>
        ask  (micro_model_2.M2_exp <span class="hljs-keyword">collect</span> <span class="hljs-keyword">each</span>.simulation){
            <span class="hljs-keyword">do</span> die;
        }
        ask (micro_model_2.M2_exp){
            create simulation{<span class="hljs-keyword">do</span> _init_;}
        }
    }
}

experiment Comodel_simple_exp type: gui
{
}
</code></pre>
<script>hljs.initHighlightingOnLoad();</script></body></html>