<html><!-- Online page at https://github.com/gama-platform/gama/wiki/References/ModelLibrary/Toy Models/Predator Prey/Predator Prey Lotka-Volterra (Influence of Integration Step) --><head><meta charset="utf-8"><title>Predator Prey Lotka Volterra (Influence of Integration Step)</title><script src="../../../../../dash_resources/highlight.all.js"></script><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/github-markdown.css"><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/highlightjs.github.css"></head><body class="markdown-body" style="padding-bottom:20px; margin: 8px 13px;"><h1 id="predator-prey-lotka-volterra-influence-of-integration-step">Predator Prey Lotka Volterra (Influence of Integration Step)</h1>
<h1 id="ode_lotkavolterra">ODE_LotkaVolterra</h1>
<p><em>Author : Huynh Quang Nghi &amp; Nathalie Corson</em></p>
<p>Code of the model : </p>
<pre><code class="hljs maxima">
model ODE_LotkaVolterra_InfluenceTimeStep

global {

    <span class="hljs-built_in">float</span> prey_birth_rate ;         // natural birth rate of preys
    <span class="hljs-built_in">float</span> predation_rate ;          // death rate of preys due to predators
    <span class="hljs-built_in">float</span> predator_death_rate ;     // natural death rate of predators
    <span class="hljs-built_in">float</span> predation_efficiency ;    // birth rate of predators due to prey consumption
    
    <span class="hljs-built_in">float</span> nb_prey_init ;            // initial number of preys
    <span class="hljs-built_in">float</span> nb_predator_init  ;       // initial number of predators
    
    <span class="hljs-built_in">float</span> integration_step ;    // integration <span class="hljs-built_in">time</span> <span class="hljs-keyword">step</span> of the Runge Kutta <span class="hljs-number">4</span> <span class="hljs-built_in">method</span>
    <span class="hljs-built_in">float</span> t;                    // simulation <span class="hljs-built_in">time</span> : t = n * integration_time_step  where n <span class="hljs-built_in">is</span> the number of already computed <span class="hljs-built_in">time</span> <span class="hljs-keyword">step</span>
    
    
    <span class="hljs-built_in">float</span> integration_time_step1  &lt;- <span class="hljs-number">1.0</span>;  // <span class="hljs-built_in">first</span> integration <span class="hljs-built_in">time</span> <span class="hljs-keyword">step</span> to <span class="hljs-built_in">compare</span> 
    <span class="hljs-built_in">float</span> integration_time_step2  &lt;- <span class="hljs-number">0.1</span>;  // <span class="hljs-built_in">second</span> integration <span class="hljs-built_in">time</span> <span class="hljs-keyword">step</span> to <span class="hljs-built_in">compare</span> 
    <span class="hljs-built_in">float</span> integration_time_step3  &lt;- <span class="hljs-number">0.01</span>;  // <span class="hljs-built_in">third</span> integration <span class="hljs-built_in">time</span> <span class="hljs-keyword">step</span> to <span class="hljs-built_in">compare</span> 
    
    list&lt;LotkaVolterra_agent&gt; LV_agents;
    
    init{
        create LotkaVolterra_agent number: <span class="hljs-number">1</span> with:[integration_time_step::integration_time_step1];  // creation of an agent containing the ODE model with an integration <span class="hljs-built_in">time</span> <span class="hljs-keyword">step</span> of value integration_time_step1
        create LotkaVolterra_agent number: <span class="hljs-number">1</span> with:[integration_time_step::integration_time_step2];  // creation of an agent containing the ODE model with an integration <span class="hljs-built_in">time</span> <span class="hljs-keyword">step</span> of value integration_time_step2
        create LotkaVolterra_agent number: <span class="hljs-number">1</span> with:[integration_time_step::integration_time_step3];  // creation of an agent containing the ODE model with an integration <span class="hljs-built_in">time</span> <span class="hljs-keyword">step</span> of value integration_time_step3
        LV_agents &lt;- list(LotkaVolterra_agent);
    }
}

species LotkaVolterra_agent {
    
    <span class="hljs-built_in">float</span> nb_prey &lt;- nb_prey_init ;                 // number of preys initialized with the <span class="hljs-built_in">values</span> given by the user
    <span class="hljs-built_in">float</span> nb_predator &lt;- nb_predator_init ;         // number of predators initialized with the <span class="hljs-built_in">values</span> given by the user
    
    <span class="hljs-built_in">float</span> integration_time_step ;                   // integration <span class="hljs-built_in">time</span> <span class="hljs-keyword">step</span> used <span class="hljs-keyword">in</span> the Runge Kutta <span class="hljs-number">4</span> <span class="hljs-built_in">method</span>
  
    equation lotka_volterra { 
        <span class="hljs-built_in">diff</span>(nb_prey,t) =   nb_prey * (prey_birth_rate - predation_rate * nb_predator);                     // <span class="hljs-built_in">evolution</span> of the number of preys duting an integration <span class="hljs-built_in">time</span> <span class="hljs-keyword">step</span>
        <span class="hljs-built_in">diff</span>(nb_predator,t) = - nb_predator * (predator_death_rate - predation_efficiency * nb_prey);       // <span class="hljs-built_in">evolution</span> of the number of predator during an integration <span class="hljs-built_in">time</span> <span class="hljs-keyword">step</span>
      }
      reflex solving {        
        <span class="hljs-built_in">solve</span> lotka_volterra <span class="hljs-built_in">method</span>: <span class="hljs-string">"rk4"</span> <span class="hljs-keyword">step</span>:integration_time_step;// cycle_length:<span class="hljs-number">1</span>/integration_time_step;          // use of runge kutta <span class="hljs-number">4</span> <span class="hljs-built_in">method</span> with an integration <span class="hljs-built_in">time</span> <span class="hljs-keyword">step</span> of value integration_time_step
       }
}


experiment maths type: gui {
        
    parameter <span class="hljs-string">"Prey birth rate"</span> <span class="hljs-built_in">var</span>: prey_birth_rate &lt;- <span class="hljs-number">0.05</span> <span class="hljs-built_in">min</span>: <span class="hljs-number">0.0</span> <span class="hljs-built_in">max</span>: <span class="hljs-number">1.0</span> category: <span class="hljs-string">"Prey"</span>;                        // the user defines the value of parameter prey_birth_rate on the interface, the default value <span class="hljs-built_in">is</span> <span class="hljs-number">0.05</span> <span class="hljs-keyword">and</span> this value must be between <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>
    parameter <span class="hljs-string">"Predation rate"</span> <span class="hljs-built_in">var</span>: predation_rate &lt;- <span class="hljs-number">0.001</span> <span class="hljs-built_in">min</span>: <span class="hljs-number">0.0</span> <span class="hljs-built_in">max</span>: <span class="hljs-number">1.0</span> category: <span class="hljs-string">"Prey"</span>;                         // the user defines the value of parameter prey_birth_rate on the interface, the default value <span class="hljs-built_in">is</span> <span class="hljs-number">0.001</span> <span class="hljs-keyword">and</span> this value must be between <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>
    parameter <span class="hljs-string">"Predator death rate"</span> <span class="hljs-built_in">var</span>: predator_death_rate &lt;- <span class="hljs-number">0.03</span> <span class="hljs-built_in">min</span>: <span class="hljs-number">0.0</span> <span class="hljs-built_in">max</span>: <span class="hljs-number">1.0</span> category: <span class="hljs-string">"Predator"</span>;            // the user defines the value of parameter predator_death_rate on the interface, the default value <span class="hljs-built_in">is</span> <span class="hljs-number">0.03</span> <span class="hljs-keyword">and</span> this value must be between <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>
    parameter <span class="hljs-string">"Predation efficiency"</span> <span class="hljs-built_in">var</span>: predation_efficiency &lt;- <span class="hljs-number">0.0002</span> <span class="hljs-built_in">min</span>: <span class="hljs-number">0.0</span> <span class="hljs-built_in">max</span>: <span class="hljs-number">1.0</span> category: <span class="hljs-string">"Predator"</span>;        // the user defines the value of parameter predation_efficiency on the interface, the default value <span class="hljs-built_in">is</span> <span class="hljs-number">0.0002</span> <span class="hljs-keyword">and</span> this value must be between <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>
    
    parameter <span class="hljs-string">"Initial number of prey"</span> <span class="hljs-built_in">var</span>: nb_prey_init &lt;- <span class="hljs-number">250.0</span> <span class="hljs-built_in">min</span>: <span class="hljs-number">1.0</span> category: <span class="hljs-string">"Prey"</span>;                            // the user defines the value of parameter predation_efficiency on the interface, the default value <span class="hljs-built_in">is</span> <span class="hljs-number">250</span>, the minimum possible value <span class="hljs-built_in">is</span> <span class="hljs-number">1</span>
    parameter <span class="hljs-string">"Initial number of predator"</span> <span class="hljs-built_in">var</span>: nb_predator_init &lt;- <span class="hljs-number">45.0</span> <span class="hljs-built_in">min</span>: <span class="hljs-number">1.0</span> category: <span class="hljs-string">"Predator"</span>;                 // the user defines the value of parameter predation_efficiency on the interface, the default value <span class="hljs-built_in">is</span> <span class="hljs-number">45</span>, the minimum possible value <span class="hljs-built_in">is</span> <span class="hljs-number">1</span>
    
    parameter <span class="hljs-string">"Integration time step of the first chart "</span> <span class="hljs-built_in">var</span>:  integration_time_step1 &lt;- <span class="hljs-number">1.0</span>  <span class="hljs-built_in">min</span>: <span class="hljs-number">0.0</span> <span class="hljs-built_in">max</span>:<span class="hljs-number">1.0</span> category: <span class="hljs-string">"Integration time steps"</span>;     // the user defines the value of the <span class="hljs-built_in">first</span> integration <span class="hljs-keyword">step</span> he wants to <span class="hljs-built_in">compare</span>, the default value <span class="hljs-built_in">is</span> <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> this value must be between <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>
    parameter <span class="hljs-string">"Integration time step of the second chart "</span> <span class="hljs-built_in">var</span>:  integration_time_step2 &lt;- <span class="hljs-number">0.1</span>  <span class="hljs-built_in">min</span>: <span class="hljs-number">0.0</span> <span class="hljs-built_in">max</span>: <span class="hljs-number">1.0</span> category: <span class="hljs-string">"Integration time steps"</span>;   // the user defines the value of the <span class="hljs-built_in">second</span> integration <span class="hljs-keyword">step</span> he wants to <span class="hljs-built_in">compare</span>, the default value <span class="hljs-built_in">is</span> <span class="hljs-number">0.1</span> <span class="hljs-keyword">and</span> this value must be between <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>
    parameter <span class="hljs-string">"Integration time step of the third chart "</span> <span class="hljs-built_in">var</span>:  integration_time_step3 &lt;- <span class="hljs-number">0.01</span>  <span class="hljs-built_in">min</span>: <span class="hljs-number">0.0</span> <span class="hljs-built_in">max</span>: <span class="hljs-number">1.0</span> category: <span class="hljs-string">"Integration time steps"</span>;   // the user defines the value of the <span class="hljs-built_in">third</span> integration <span class="hljs-keyword">step</span> he wants to <span class="hljs-built_in">compare</span>, the default value <span class="hljs-built_in">is</span> <span class="hljs-number">0.01</span> <span class="hljs-keyword">and</span> this value must be between <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>
        
    output {        
        <span class="hljs-built_in">display</span> TimeSeries  {   // creation of a <span class="hljs-built_in">display</span> to <span class="hljs-built_in">show</span> <span class="hljs-built_in">time</span> series of the model, <span class="hljs-built_in">values</span> are plotted <span class="hljs-built_in">at</span> <span class="hljs-built_in">every</span> <span class="hljs-keyword">step</span>. Since there <span class="hljs-built_in">is</span> more than one chart plotted <span class="hljs-keyword">in</span> one <span class="hljs-built_in">display</span>, <span class="hljs-built_in">every</span> chart has a <span class="hljs-built_in">position</span> <span class="hljs-keyword">and</span> a size
            chart <span class="hljs-string">"Lotka Volterra Time Series - Integration time step = 1 "</span> type: series <span class="hljs-built_in">background</span>: #white <span class="hljs-built_in">position</span>: {<span class="hljs-number">0</span>,<span class="hljs-number">0</span>} size:{<span class="hljs-number">1</span>,<span class="hljs-number">0.33</span>} x_range: <span class="hljs-number">1000</span> {       // one chart, of type 'serie', <span class="hljs-built_in">is</span> named Lotka Volterra Time Series - Integration <span class="hljs-built_in">time</span> <span class="hljs-keyword">step</span> = <span class="hljs-number">1</span>, it shows quantities according to <span class="hljs-built_in">time</span>, <span class="hljs-keyword">and</span> the <span class="hljs-built_in">background</span> <span class="hljs-built_in">is</span> white
                data 'Number of preys' value: <span class="hljs-built_in">first</span>(LotkaVolterra_agent where (each.integration_time_step = <span class="hljs-number">1.0</span>)).nb_prey <span class="hljs-built_in">color</span>: #green ;           // number of preys <span class="hljs-keyword">in</span> the case where the integration <span class="hljs-built_in">time</span> <span class="hljs-keyword">step</span> <span class="hljs-built_in">is</span> <span class="hljs-number">1</span> <span class="hljs-built_in">is</span> plotted <span class="hljs-keyword">in</span> green     
                data 'Number of predators' value: <span class="hljs-built_in">first</span>(LotkaVolterra_agent where (each.integration_time_step = <span class="hljs-number">1.0</span>)).nb_predator <span class="hljs-built_in">color</span>: #red ;     // number of predators <span class="hljs-keyword">in</span> the case where the integration <span class="hljs-built_in">time</span> <span class="hljs-keyword">step</span> <span class="hljs-built_in">is</span> <span class="hljs-number">1</span> <span class="hljs-built_in">is</span> plotted <span class="hljs-keyword">in</span> red   
            }
            chart <span class="hljs-string">"Lotka Volterra Time Series - Integration time step = 0.1 "</span> type: series <span class="hljs-built_in">background</span>: #white <span class="hljs-built_in">position</span>: {<span class="hljs-number">0</span>,<span class="hljs-number">0.33</span>} size:{<span class="hljs-number">1</span>,<span class="hljs-number">0.33</span>} x_range: <span class="hljs-number">1000</span>{
                data 'Number of preys' value: <span class="hljs-built_in">first</span>(LotkaVolterra_agent where (each.integration_time_step = <span class="hljs-number">0.1</span>)).nb_prey <span class="hljs-built_in">color</span>: #green ;               
                data 'Number of predators' value: <span class="hljs-built_in">first</span>(LotkaVolterra_agent where (each.integration_time_step = <span class="hljs-number">0.1</span>)).nb_predator <span class="hljs-built_in">color</span>: #red ;
            }
            chart <span class="hljs-string">"Lotka Volterra Time Series - Integration time step = 0.01 "</span> type: series <span class="hljs-built_in">background</span>: #white <span class="hljs-built_in">position</span>: {<span class="hljs-number">0</span>,<span class="hljs-number">0.66</span>} size:{<span class="hljs-number">1</span>,<span class="hljs-number">0.33</span>}x_range: <span class="hljs-number">1000</span>{
                data 'Number of preys' value: <span class="hljs-built_in">first</span>(LotkaVolterra_agent where (each.integration_time_step = <span class="hljs-number">0.01</span>)).nb_prey <span class="hljs-built_in">color</span>: #green ;              
                data 'Number of predators' value: <span class="hljs-built_in">first</span>(LotkaVolterra_agent where (each.integration_time_step = <span class="hljs-number">0.01</span>)).nb_predator <span class="hljs-built_in">color</span>: #red ;
            }
        }
        <span class="hljs-built_in">display</span> PhasePortrait {         
            chart <span class="hljs-string">"Lotka Volterra Phase Portrait - Integration time step = 1"</span> type: xy <span class="hljs-built_in">background</span>: #white <span class="hljs-built_in">position</span>: {<span class="hljs-number">0</span>,<span class="hljs-number">0</span>} size:{<span class="hljs-number">1</span>,<span class="hljs-number">0.33</span>} {       // creation of a <span class="hljs-built_in">display</span> to <span class="hljs-built_in">show</span> phase portrait of the model, <span class="hljs-built_in">values</span> are plotted <span class="hljs-built_in">at</span> <span class="hljs-built_in">every</span> <span class="hljs-keyword">step</span>. Since there <span class="hljs-built_in">is</span> more than one chart plotted <span class="hljs-keyword">in</span> one <span class="hljs-built_in">display</span>, <span class="hljs-built_in">every</span> chart has a <span class="hljs-built_in">position</span> <span class="hljs-keyword">and</span> a size
            data 'Number of preys according to number of predators' value:{LV_agents[<span class="hljs-number">0</span>].nb_prey, LV_agents[<span class="hljs-number">0</span>].nb_predator} <span class="hljs-built_in">color</span>: #black ;  // number of predators are plotted <span class="hljs-keyword">in</span> black according to the number of preys <span class="hljs-keyword">in</span> the case where the integration <span class="hljs-built_in">time</span> <span class="hljs-keyword">step</span> <span class="hljs-built_in">is</span> <span class="hljs-number">1</span>       
            }
            chart <span class="hljs-string">"Lotka Volterra Phase Portrait - Integration time step = 0.1"</span> type: xy <span class="hljs-built_in">background</span>: #white <span class="hljs-built_in">position</span>: {<span class="hljs-number">0</span>,<span class="hljs-number">0.33</span>} size:{<span class="hljs-number">1</span>,<span class="hljs-number">0.33</span>}{
            data 'Number of preys according to number of predators' value:{LV_agents[<span class="hljs-number">1</span>].nb_prey, LV_agents[<span class="hljs-number">1</span>].nb_predator} <span class="hljs-built_in">color</span>: #black ;              
            }
            chart <span class="hljs-string">"Lotka Volterra Phase Portrait - Integration time step = 0.01"</span> type: xy <span class="hljs-built_in">background</span>: #white <span class="hljs-built_in">position</span>: {<span class="hljs-number">0</span>,<span class="hljs-number">0.66</span>} size:{<span class="hljs-number">1</span>,<span class="hljs-number">0.33</span>} {
            data 'Number of preys according to number of predators' value:{LV_agents[<span class="hljs-number">1</span>].nb_prey, LV_agents[<span class="hljs-number">1</span>].nb_predator} <span class="hljs-built_in">color</span>: #black ;              
            }
        }
    }
}
</code></pre>
<script>hljs.initHighlightingOnLoad();</script></body></html>