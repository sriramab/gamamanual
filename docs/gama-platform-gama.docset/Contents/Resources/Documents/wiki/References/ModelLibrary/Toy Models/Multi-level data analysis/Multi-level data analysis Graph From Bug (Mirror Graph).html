<html><!-- Online page at https://github.com/gama-platform/gama/wiki/References/ModelLibrary/Toy Models/Multi-level data analysis/Multi-level data analysis Graph From Bug (Mirror Graph) --><head><meta charset="utf-8"><title>Multi level data analysis Graph From Bug (Mirror Graph)</title><script src="../../../../../dash_resources/highlight.all.js"></script><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/github-markdown.css"><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/highlightjs.github.css"></head><body class="markdown-body" style="padding-bottom:20px; margin: 8px 13px;"><h1 id="multi-level-data-analysis-graph-from-bug-mirror-graph">Multi level data analysis Graph From Bug (Mirror Graph)</h1>
<h1 id="spatialgraph3d">SpatialGraph3d</h1>
<p><em>Author : Arnaud Grignard</em></p>
<p>From the reference model "bug.gaml" a spatial graph is created. We create a species node that mirrors the species bug and then a spatial graph is creating using as_distance_graph operator. The species node should then define its own related_to method to decide wether or not a node is related to another one.</p>
<p>Code of the model : </p>
<pre><code class="hljs http">

<span class="processing">model Graph

<span class="hljs-comment">//Import the model Common Bug Species model</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">'../includes/Common Bug Species.gaml'</span>

global {
    <span class="hljs-comment">//Distance to link two bugs</span>
    <span class="hljs-built_in">int</span> distance parameter: <span class="hljs-string">'Distance'</span> <span class="hljs-built_in">min</span>: <span class="hljs-number">1</span> &lt;- <span class="hljs-number">25</span> category: <span class="hljs-string">'Model'</span>;
    <span class="hljs-comment">//variable to start the animation of the model</span>
    <span class="hljs-built_in">int</span> startAnimation parameter: <span class="hljs-string">'Start Animation '</span> <span class="hljs-built_in">min</span>: <span class="hljs-number">1</span> &lt;- <span class="hljs-number">25</span> category: <span class="hljs-string">'Animation View'</span>;
    <span class="hljs-comment">//Variable to save the time animation</span>
    <span class="hljs-built_in">int</span> timeAnim &lt;- <span class="hljs-number">0</span>;
    <span class="hljs-comment">//Reflex to update the time of animation</span>
    reflex updateAnimation 
    {
        <span class="hljs-keyword">if</span> (time &gt; startAnimation) 
        {
            timeAnim &lt;- <span class="hljs-built_in">int</span>(time - startAnimation);
        }
    }
}
<span class="hljs-comment">//Species node_agent mirroring the bug species, represented as graph node</span>
species node_agent mirrors: list(bug) parent: graph_node edge_species: edge_agent {
    <span class="hljs-comment">//Their location is the one of the target location</span>
    <span class="hljs-built_in">point</span> location &lt;- target.location update: target.location;
    
    <span class="hljs-comment">//Action to know if an agent is related to another agent considering their distance</span>
    bool related_to (node_agent other) {
        using topology(target) {
            <span class="hljs-keyword">return</span> (target.location distance_to other.target.location) &lt; distance;
        }

    }

    aspect base {
        <span class="hljs-title">draw</span> <span class="hljs-built_in">sphere</span>(<span class="hljs-number">2</span>) <span class="hljs-built_in">color</span>: #<span class="hljs-built_in">green</span>;
    }

    aspect dynamic {
        <span class="hljs-built_in">int</span> degree &lt;- (my_graph) degree_of (self);
        <span class="hljs-title">draw</span> <span class="hljs-built_in">sphere</span>(<span class="hljs-number">1</span> + (degree / <span class="hljs-number">5.0</span>)) <span class="hljs-built_in">color</span>: #<span class="hljs-built_in">blue</span>;
    }

}
<span class="hljs-comment">//Species edge to represent the edges of the graph</span>
species edge_agent parent: base_edge {
    rgb <span class="hljs-built_in">color</span>;
    aspect base {
        <span class="hljs-title">draw</span> <span class="hljs-built_in">shape</span> <span class="hljs-built_in">color</span>: #<span class="hljs-built_in">green</span>;
    }
    
    aspect dynamic {
        <span class="hljs-built_in">shape</span> &lt;- <span class="hljs-built_in">line</span>([{ self.source.location.x, self.source.location.y, self.source.location.z }, { self.target.location.x, self.target.location.y, self.target.location.z }]);
        <span class="hljs-built_in">float</span> val &lt;- <span class="hljs-number">255.0</span> * (<span class="hljs-built_in">shape</span>.perimeter / distance);
        <span class="hljs-built_in">color</span> &lt;- hsb(val, <span class="hljs-number">1.0</span>, <span class="hljs-number">1.0</span>);
        <span class="hljs-title">draw</span> <span class="hljs-built_in">shape</span> + <span class="hljs-number">0.1</span> <span class="hljs-built_in">color</span>: <span class="hljs-built_in">color</span> border: <span class="hljs-built_in">color</span>;
    }

}

experiment AdvancedView type: gui {
    output {
        display graph_plus_bug_layered type: opengl { 
          species bug aspect: base;
          species node_agent aspect: base position: { <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.2</span> };
          species edge_agent aspect: base position: { <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.2</span> };
          species node_agent aspect: dynamic position: { <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.4</span> };
          species edge_agent aspect: dynamic position: { <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.4</span> };
        }
    }
}

</span></code></pre>
<script>hljs.initHighlightingOnLoad();</script></body></html>