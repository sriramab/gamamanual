<html><!-- Online page at https://github.com/gama-platform/gama/wiki/References/ModelLibrary/Toy Models/Ants (Foraging and Sorting)/Ants (Foraging and Sorting) Ant Foraging (Classic) --><head><meta charset="utf-8"><title>Ants (Foraging and Sorting) Ant Foraging (Classic)</title><script src="../../../../../dash_resources/highlight.all.js"></script><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/github-markdown.css"><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/highlightjs.github.css"></head><body class="markdown-body" style="padding-bottom:20px; margin: 8px 13px;"><h1 id="ants-foraging-and-sorting-ant-foraging-classic">Ants (Foraging and Sorting) Ant Foraging (Classic)</h1>
<h1 id="ant-foraging-classic">Ant Foraging (Classic)</h1>
<p>_Author : _</p>
<p>Toy Model ant using the question of how ants search food and use pheromons to return to their nest once they did find food. This model is considered as the classic one.</p>
<p>Code of the model : </p>
<pre><code class="hljs zephir">model ants

<span class="hljs-keyword">global</span> {
    <span class="hljs-comment">//Number of ants</span>
    <span class="hljs-keyword">int</span> ants_number &lt;- <span class="hljs-number">100</span> min: <span class="hljs-number">1</span> max: <span class="hljs-number">2000</span> ;
    <span class="hljs-comment">//Evaporation value per cycle</span>
    <span class="hljs-keyword">float</span> evaporation_per_cycle &lt;- <span class="hljs-number">5.0</span> min: <span class="hljs-number">0.0</span> max: <span class="hljs-number">240.0</span> ;
    <span class="hljs-comment">//Diffusion rate for the pheromon diffused among the grid</span>
    <span class="hljs-keyword">float</span> diffusion_rate &lt;- <span class="hljs-number">0.5</span> min: <span class="hljs-number">0.0</span> max: <span class="hljs-number">1.0</span> ;
    <span class="hljs-keyword">bool</span> use_icons &lt;- <span class="hljs-keyword">true</span> ;
    <span class="hljs-keyword">bool</span> display_state &lt;- <span class="hljs-keyword">true</span>;
    <span class="hljs-comment">//Size of the grid</span>
    <span class="hljs-keyword">int</span> gridsize &lt;- <span class="hljs-number">75</span> ;
    <span class="hljs-comment">//Center of the grid that will be used as a nest for the ants</span>
    point center <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- { (gridsize / <span class="hljs-number">2</span>),  (gridsize / <span class="hljs-number">2</span>)} ;
    file types <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- (pgm_file(<span class="hljs-string">'../images/environment75x75.pgm'</span>)) ;
    string ant_shape_empty <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- <span class="hljs-string">'../icons/ant.png'</span> ;
    string ant_shape_full <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- <span class="hljs-string">'../icons/full_ant.png'</span>  ;
    rgb C00CC00 <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- rgb(<span class="hljs-string">'#00CC00'</span>) ;    
    rgb C009900 <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- rgb(<span class="hljs-string">'#009900'</span>) ; 
    rgb C005500 <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- rgb(<span class="hljs-string">'#005500'</span>) ; 
    <span class="hljs-keyword">int</span> food_gathered &lt;- <span class="hljs-number">0</span> ;    
    geometry shape &lt;- square(gridsize);
    init{  
        <span class="hljs-comment">//Creation of the ants that will be placed randomly in the nest</span>
        create ant number: ants_number with: [location::any_location_in (ant_grid(center))] ;
    }
    <span class="hljs-comment">//Reflex to diffuse the pheromon among the grid</span>
    reflex diffuse {
      diffuse <span class="hljs-keyword">var</span>:road on:ant_grid proportion: diffusion_rate radius:<span class="hljs-number">2</span> propagation: gradient;
   }

}

<span class="hljs-comment">//Grid that will be used to place the food in a discretized space</span>
grid ant_grid width: gridsize height: gridsize neighbors: <span class="hljs-number">8</span> use_regular_agents: <span class="hljs-keyword">false</span> {
    <span class="hljs-keyword">list</span>&lt;ant_grid&gt; neighbours &lt;- <span class="hljs-keyword">self</span> neighbors_at <span class="hljs-number">1</span>;
    <span class="hljs-keyword">float</span> road &lt;- <span class="hljs-number">0.0</span> max:<span class="hljs-number">240.0</span> update: (road&lt;=evaporation_per_cycle) ? <span class="hljs-number">0.0</span> : road-evaporation_per_cycle;
    <span class="hljs-keyword">int</span> type &lt;- <span class="hljs-keyword">int</span>(types at {grid_x,grid_y}) ;
    <span class="hljs-keyword">bool</span> isNestLocation &lt;- (<span class="hljs-keyword">self</span> distance_to center) &lt; <span class="hljs-number">4</span> ;
    <span class="hljs-keyword">bool</span> isFoodLocation &lt;- type = <span class="hljs-number">2</span> ; 
    rgb color &lt;- isNestLocation ? °sienna:((food &gt; <span class="hljs-number">0</span>)? °brown : ((road &lt; <span class="hljs-number">0.001</span>)? <span class="hljs-comment">#darkgoldenrod: ((road &gt; 2)? °white : ((road &gt; 0.5)? (C00CC00) : ((road &gt; 0.2)? (C009900) : (C005500)))))) update: isNestLocation ? °sienna:((food &gt; 0)? °brown : ((road &lt; 0.001)?#darkgoldenrod : ((road &gt; 2)? °white : ((road &gt; 0.5)? (C00CC00) : ((road &gt; 0.2)? (C009900) : (C005500)))))) ;</span>
    <span class="hljs-keyword">int</span> food &lt;- isFoodLocation ? <span class="hljs-number">5</span> : <span class="hljs-number">0</span> ;
    <span class="hljs-keyword">int</span> nest <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- <span class="hljs-number">300</span> - <span class="hljs-keyword">int</span>(<span class="hljs-keyword">self</span> distance_to center) ;
    
}
<span class="hljs-comment">//Species ant that will move and follow a final state machine</span>
species ant skills: [moving] control: fsm {
    <span class="hljs-keyword">float</span> speed &lt;- <span class="hljs-number">2.0</span> ;
    ant_grid place update: ant_grid (location ); 
    string im &lt;- <span class="hljs-string">'ant_shape_empty'</span> ;
    <span class="hljs-keyword">bool</span> hasFood &lt;- <span class="hljs-keyword">false</span> ;
    <span class="hljs-comment">//Reflex to allow the diffusion of the road of pheromon by putting pheromon inside a cell</span>
    reflex diffuse_road when:hasFood=<span class="hljs-keyword">true</span>{
      ant_grid(location).road &lt;- ant_grid(location).road + <span class="hljs-number">100.0</span>;
   }
   <span class="hljs-comment">//Action to pick the food</span>
    action pick {
        im &lt;- ant_shape_full ;
        hasFood &lt;- <span class="hljs-keyword">true</span> ;
        place.food &lt;- place.food - <span class="hljs-number">1</span> ;
    }
    <span class="hljs-comment">//Action to drop the food</span>
    action drop {
        food_gathered &lt;- food_gathered + <span class="hljs-number">1</span> ;  
        hasFood &lt;- <span class="hljs-keyword">false</span> ;
        heading &lt;- heading - <span class="hljs-number">180</span> ;
    }
    <span class="hljs-comment">//Action to find the best cell in the neighbourhood of the ant</span>
    action choose_best_place type: ant_grid {  
        <span class="hljs-keyword">list</span>&lt;ant_grid&gt; list_places &lt;- place.neighbours ;
        <span class="hljs-keyword">if</span> (list_places count (each.food &gt; <span class="hljs-number">0</span>)) &gt; <span class="hljs-number">0</span>  { 
            <span class="hljs-keyword">return</span> (list_places first_with (each.food &gt; <span class="hljs-number">0</span>)) ;
        } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">int</span> min_nest  &lt;-  (list_places min_of (each.nest)) ;
                list_places &lt;- list_places sort ((each.nest = min_nest) ? each.road :  <span class="hljs-number">0.0</span>) ;
                <span class="hljs-keyword">return</span> last(list_places) ;
            }
    } 
    <span class="hljs-comment">//initial state of the ant that will make it wander until it finds food or a road</span>
    state wandering initial: <span class="hljs-keyword">true</span> { 
        <span class="hljs-keyword">do</span> wander amplitude:<span class="hljs-number">120</span> ;
        transition to: carryingFood when: place.food &gt; <span class="hljs-number">0</span> {
            
             
            <span class="hljs-keyword">do</span> pick ;
        }
        transition to: followingRoad when: place.road &gt; <span class="hljs-number">0.05</span> ; 
    }
    <span class="hljs-comment">//State to carry food to the nest once it has been found</span>
    state carryingFood {
        <span class="hljs-keyword">do</span> <span class="hljs-keyword">goto</span> target: center ;
        transition to: wandering when: place.isNestLocation { 
            <span class="hljs-keyword">do</span> drop ;
        }
    }
    <span class="hljs-comment">//State to follow a pheromon road once it has been found</span>
    state followingRoad {
        location &lt;- (<span class="hljs-keyword">self</span> choose_best_place()) <span class="hljs-keyword">as</span> point ;
        transition to: carryingFood when: place.food &gt; <span class="hljs-number">0</span> {
            <span class="hljs-keyword">do</span> pick ;
        }
        transition to: wandering when: (place.road &lt; <span class="hljs-number">0.05</span>) ;
    }
    aspect text {
        <span class="hljs-keyword">if</span> use_icons {
            draw  hasFood ? file(ant_shape_full) : file(ant_shape_empty) rotate: heading at: location size: {<span class="hljs-number">8</span>,<span class="hljs-number">5</span>} ;
        } <span class="hljs-keyword">else</span> {
            draw circle(<span class="hljs-number">1.0</span>) <span class="hljs-keyword">empty</span>: !hasFood color: rgb (<span class="hljs-string">'orange'</span>) ;
        }
        <span class="hljs-keyword">if</span> display_state {
            draw state at: location + {<span class="hljs-number">-3</span>,<span class="hljs-number">1.5</span>} color: °white font: font(<span class="hljs-string">"Helvetica"</span>, <span class="hljs-number">14</span> * <span class="hljs-comment">#zoom, #plain) perspective:true;</span>
        }
    } 
    aspect <span class="hljs-keyword">default</span> {
        draw circle(<span class="hljs-number">1.0</span>) <span class="hljs-keyword">empty</span>: !hasFood color: <span class="hljs-comment">#orange ; </span>
    }           
}

experiment Ant type: gui {
    parameter <span class="hljs-string">'Number of ants:'</span> <span class="hljs-keyword">var</span>: ants_number category: <span class="hljs-string">'Model'</span> ;
    parameter <span class="hljs-string">'Evaporation of the signal (unit/cycle):'</span> <span class="hljs-keyword">var</span>: evaporation_per_cycle category: <span class="hljs-string">'Model'</span> ;
    parameter <span class="hljs-string">'Rate of diffusion of the signal (%/cycle):'</span> <span class="hljs-keyword">var</span>: diffusion_rate category: <span class="hljs-string">'Model'</span> ;
    parameter <span class="hljs-string">'Use icons for the agents:'</span> <span class="hljs-keyword">var</span>: use_icons category: <span class="hljs-string">'Display'</span> ;
    parameter <span class="hljs-string">'Display state of agents:'</span> <span class="hljs-keyword">var</span>: display_state category: <span class="hljs-string">'Display'</span> ;
    output {
        display Ants type: opengl  {
            grid ant_grid ;
            species ant aspect: text ;
        }
    }
}

</code></pre>
<script>hljs.initHighlightingOnLoad();</script></body></html>