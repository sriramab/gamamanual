<html><!-- Online page at https://github.com/gama-platform/gama/wiki/References/ModelLibrary/Features/Agent movement/Agent movement Follow Path --><head><meta charset="utf-8"><title>Agent movement Follow Path</title><script src="../../../../../dash_resources/highlight.all.js"></script><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/github-markdown.css"><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/highlightjs.github.css"></head><body class="markdown-body" style="padding-bottom:20px; margin: 8px 13px;"><h1 id="agent-movement-follow-path">Agent movement Follow Path</h1>
<h1 id="movement-of-an-agent-on-different-paths">Movement of an agent on different paths</h1>
<p>_Author : _</p>
<p>Model showing the movement of an agent following three different paths : one defined by its vertices, an other defined thanks to all the roads species, and finally a path defined by a graph with weights (graph created thanks to an other species)</p>
<p>Code of the model : </p>
<pre><code class="hljs processing">model path_and_follow

global{
    graph the_graph;
    init{
            <span class="hljs-comment">//It is possible to define a road by defining its shape, being a line. The line need to be created by passing the location of the vertices</span>
       create road {
            <span class="hljs-built_in">shape</span> &lt;- <span class="hljs-built_in">line</span>([{<span class="hljs-number">0</span>,<span class="hljs-number">50</span>},{<span class="hljs-number">40</span>,<span class="hljs-number">60</span>}]);
       }
       create road {
            <span class="hljs-built_in">shape</span> &lt;- <span class="hljs-built_in">line</span>([{<span class="hljs-number">40</span>,<span class="hljs-number">60</span>},{<span class="hljs-number">50</span>,<span class="hljs-number">50</span>},{<span class="hljs-number">55</span>,<span class="hljs-number">60</span>}]);
       }
       create road {
            <span class="hljs-built_in">shape</span> &lt;- <span class="hljs-built_in">line</span>([{<span class="hljs-number">55</span>,<span class="hljs-number">60</span>},{<span class="hljs-number">65</span>,<span class="hljs-number">40</span>}]);
       }
       
       create road_of_graph {
            <span class="hljs-built_in">shape</span> &lt;- <span class="hljs-built_in">line</span>([{<span class="hljs-number">65</span>,<span class="hljs-number">40</span>},{<span class="hljs-number">75</span>,<span class="hljs-number">35</span>}]);
       }
       create road_of_graph {
            <span class="hljs-built_in">shape</span> &lt;- <span class="hljs-built_in">line</span>([{<span class="hljs-number">75</span>,<span class="hljs-number">35</span>},{<span class="hljs-number">85</span>,<span class="hljs-number">40</span>},{<span class="hljs-number">80</span>,<span class="hljs-number">60</span>}]);
       }
       <span class="hljs-comment">//It is possible to define a weights map by linking the road and their weights (the road will be the key of the weight)</span>
       <span class="hljs-built_in">map</span>&lt;road_of_graph,<span class="hljs-built_in">float</span>&gt; weight_map &lt;- road_of_graph as_map (each::each.<span class="hljs-built_in">shape</span>.perimeter * <span class="hljs-number">10</span>);
       
       <span class="hljs-comment">//A graph can be defined by using a list or all the agents of a species and it is possible to use a map of weights with each key </span>
       <span class="hljs-comment">// of the map being a road to link the road and its weight</span>
       <span class="hljs-comment">//The as_edge_graph operator is an operator creating a graph using the list of agents passed as edges of the graph</span>
       the_graph &lt;- as_edge_graph(road_of_graph) with_weights weight_map;
      
       create myCircle {
            location &lt;- {<span class="hljs-number">0</span>,<span class="hljs-number">0</span>};
       }
      
    }  
}

species myCircle skills:[moving]{
    <span class="hljs-comment">//The different ways to declare a path : declaring all the lines of the path using their vertices</span>
    <span class="hljs-comment">//                            using a list of agents representing the lines of the path</span>
    <span class="hljs-comment">//                            using the graph as a path</span>
    
    
    path path_to_follow1 &lt;- path([{<span class="hljs-number">0</span>,<span class="hljs-number">0</span>},{<span class="hljs-number">10</span>,<span class="hljs-number">10</span>},{<span class="hljs-number">0</span>,<span class="hljs-number">20</span>},{<span class="hljs-number">20</span>,<span class="hljs-number">30</span>},{<span class="hljs-number">20</span>,<span class="hljs-number">40</span>},{<span class="hljs-number">0</span>,<span class="hljs-number">50</span>}]);    
    path path_to_follow2 &lt;- path(list(road));   
    path path_to_follow3 &lt;- list(road_of_graph) as_path the_graph;  
    
    <span class="hljs-comment">//These two variables will change when the cycle will be higher than 100 and 200</span>
    path path_following&lt;- path_to_follow1;
    rgb <span class="hljs-built_in">color</span> &lt;- #<span class="hljs-built_in">green</span>;
    
    reflex myfollow{ 
        <span class="hljs-comment">//The operator follow make the agent move from the starting vertice of the starting edge of a path to the last vertice of the last edge of the path</span>
        <span class="hljs-comment">// but following the edges of the concerned path</span>
        do follow path: path_following; 
        <span class="hljs-keyword">if</span>(cycle&gt;<span class="hljs-number">200</span>)
        {
            path_following&lt;- path_to_follow3;   
            <span class="hljs-built_in">color</span>&lt;-#pink;
        }
        <span class="hljs-keyword">else</span>
        {
            <span class="hljs-keyword">if</span>(cycle&gt;<span class="hljs-number">100</span>)
            {
                path_following&lt;- path_to_follow2;   
                <span class="hljs-built_in">color</span>&lt;-#<span class="hljs-built_in">blue</span>;
            }
        }
    }
    
    aspect base {
      <span class="hljs-title">draw</span> circle(<span class="hljs-number">1</span>) <span class="hljs-built_in">color</span>:#<span class="hljs-built_in">red</span> ;   
      <span class="hljs-comment">//We loop on all the edges of the path the agent follow to display them</span>
        <span class="hljs-built_in">loop</span> seg over: path_following.edges {
            <span class="hljs-title">draw</span> seg <span class="hljs-built_in">color</span>: <span class="hljs-built_in">color</span>;
         }
      
    } 
}

species road {
    aspect base {
      <span class="hljs-title">draw</span> <span class="hljs-built_in">shape</span> <span class="hljs-built_in">color</span>:#<span class="hljs-built_in">blue</span> ;  
      
    } 
}

species road_of_graph {
    aspect base {
      <span class="hljs-title">draw</span> <span class="hljs-built_in">shape</span> <span class="hljs-built_in">color</span>:#<span class="hljs-built_in">red</span> ;   
      
    } 
}

experiment main type: gui {
    <span class="hljs-built_in">float</span> minimum_cycle_duration &lt;- <span class="hljs-number">0.10</span>;
    output {
        display myView { 
            species myCircle aspect:base; 
        }
    }
}






</code></pre>
<script>hljs.initHighlightingOnLoad();</script></body></html>