<html><!-- Online page at https://github.com/gama-platform/gama/wiki/References/ModelLibrary/Features/Database Usage/Database Usage Simple SQL Command in SQLite --><head><meta charset="utf-8"><title>Database Usage Simple SQL Command in SQLite</title><script src="../../../../../dash_resources/highlight.all.js"></script><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/github-markdown.css"><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/highlightjs.github.css"></head><body class="markdown-body" style="padding-bottom:20px; margin: 8px 13px;"><h1 id="database-usage-simple-sql-command-in-sqlite">Database Usage Simple SQL Command in SQLite</h1>
<h1 id="simple-sql-command-in-sqlite">Simple SQL Command in SQLIte</h1>
<p><em>Author : Truong Minh Thai</em></p>
<p>This model does SQl query commands:</p>
<ul>
<li></li>
<li><p>Create table </p>
</li>
<li></li>
<li><p>Insert data</p>
</li>
<li></li>
<li><p>Select data</p>
</li>
<li></li>
<li><p>Delete data</p>
</li>
<li></li>
<li><p>Drop table </p>
</li>
<li><p>Note: the file emptyFile.db is only ... an empty file.</p>
</li>
</ul>
<p>Code of the model : </p>
<pre><code class="hljs groovy">model SQLite_selectNUpdate

global {
    map&lt;string, string&gt; PARAMS &lt;- [<span class="hljs-string">'dbtype'</span>::<span class="hljs-string">'sqlite'</span>, <span class="hljs-string">'database'</span>::<span class="hljs-string">'../../includes/emptyFile.db'</span>];
    init {
        create DB_Accessor;

        <span class="hljs-comment">// Test of the connection to the database</span>
        <span class="hljs-keyword">if</span> (first(DB_Accessor) testConnection [<span class="hljs-string">params:</span>:PARAMS] = <span class="hljs-literal">false</span>) {
            write <span class="hljs-string">"Connection impossible"</span>;
            do halt;
        }

        ask (DB_Accessor) {
            do executeUpdate <span class="hljs-string">params:</span> PARAMS <span class="hljs-string">updateComm:</span> <span class="hljs-string">"CREATE TABLE registration"</span> + <span class="hljs-string">"(id INTEGER PRIMARY KEY, "</span> + <span class="hljs-string">" first TEXT NOT NULL, "</span> + <span class="hljs-string">" last TEXT NOT NULL, "</span> + <span class="hljs-string">" age INTEGER);"</span>;
            write <span class="hljs-string">"REGISTRATION table has been created."</span>;
            do executeUpdate <span class="hljs-string">params:</span> PARAMS <span class="hljs-string">updateComm:</span> <span class="hljs-string">"INSERT INTO registration "</span> + <span class="hljs-string">"VALUES(100, 'Zara', 'Ali', 18);"</span>;
            do executeUpdate <span class="hljs-string">params:</span> PARAMS <span class="hljs-string">updateComm:</span> <span class="hljs-string">"INSERT INTO registration "</span> + <span class="hljs-string">"VALUES(?, ?, ?, ?);"</span> <span class="hljs-string">values:</span> [<span class="hljs-number">101</span>, <span class="hljs-string">'Mr'</span>, <span class="hljs-string">'Mme'</span>, <span class="hljs-number">45</span>];
            do insert <span class="hljs-string">params:</span> PARAMS <span class="hljs-string">into:</span> <span class="hljs-string">"registration"</span> <span class="hljs-string">values:</span> [<span class="hljs-number">102</span>, <span class="hljs-string">'Mahnaz'</span>, <span class="hljs-string">'Fatma'</span>, <span class="hljs-number">25</span>];
            do insert <span class="hljs-string">params:</span> PARAMS <span class="hljs-string">into:</span> <span class="hljs-string">"registration"</span> <span class="hljs-string">columns:</span> [<span class="hljs-string">"id"</span>, <span class="hljs-string">"first"</span>, <span class="hljs-string">"last"</span>] <span class="hljs-string">values:</span> [<span class="hljs-number">103</span>, <span class="hljs-string">'Zaid tim'</span>, <span class="hljs-string">'Kha'</span>];
            do insert <span class="hljs-string">params:</span> PARAMS <span class="hljs-string">into:</span> <span class="hljs-string">"registration"</span> <span class="hljs-string">columns:</span> [<span class="hljs-string">"id"</span>, <span class="hljs-string">"first"</span>, <span class="hljs-string">"last"</span>] <span class="hljs-string">values:</span> [<span class="hljs-number">104</span>, <span class="hljs-string">'Bill'</span>, <span class="hljs-string">'Clark'</span>];
            write <span class="hljs-string">"Five records have been inserted."</span>;
            write <span class="hljs-string">"Click on &lt;&lt;Step&gt;&gt; button to view selected data"</span>;
        }

    }

}

species DB_Accessor <span class="hljs-string">skills:</span> [SQLSKILL] {
    reflex select {
        list&lt;list&gt; t &lt;- list&lt;list&gt; (self select [<span class="hljs-string">params:</span>:PARAMS, <span class="hljs-string">select:</span>:<span class="hljs-string">"SELECT * FROM registration"</span>]);
        write <span class="hljs-string">"Select before updated "</span> + t;
    }

    reflex update {
        do executeUpdate <span class="hljs-string">params:</span> PARAMS <span class="hljs-string">updateComm:</span> <span class="hljs-string">"UPDATE registration SET age = 30 WHERE id IN (100, 101)"</span>;
        do executeUpdate <span class="hljs-string">params:</span> PARAMS <span class="hljs-string">updateComm:</span> <span class="hljs-string">"DELETE FROM registration where id=103 "</span>;
        list&lt;list&gt; t &lt;- list&lt;list&gt; (self select [<span class="hljs-string">params:</span>:PARAMS, <span class="hljs-string">select:</span>:<span class="hljs-string">"SELECT * FROM registration"</span>]);
        write <span class="hljs-string">"Select after updated "</span> + t;
    }

    reflex drop {
        do executeUpdate <span class="hljs-string">params:</span> PARAMS <span class="hljs-string">updateComm:</span> <span class="hljs-string">"DROP TABLE registration"</span>;
        write <span class="hljs-string">"Registration table has been dropped."</span>;
    }

}

experiment simple_SQL_exp <span class="hljs-string">type:</span> gui {
}     
</code></pre>
<script>hljs.initHighlightingOnLoad();</script></body></html>