<html><!-- Online page at https://github.com/gama-platform/gama/wiki/References/ModelLibrary/Features/Agent movement/Agent movement Follow Weighted Network (Agents) --><head><meta charset="utf-8"><title>Agent movement Follow Weighted Network (Agents)</title><script src="../../../../../dash_resources/highlight.all.js"></script><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/github-markdown.css"><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/highlightjs.github.css"></head><body class="markdown-body" style="padding-bottom:20px; margin: 8px 13px;"><h1 id="agent-movement-follow-weighted-network-agents">Agent movement Follow Weighted Network (Agents)</h1>
<h1 id="follow-weighted-network">Follow Weighted Network</h1>
<p><em>Author :  Martine Taillandier</em></p>
<p>Model representing how to make a weighted graph and the impacts of the weights on the time to follow the path for the agents. Two agents are represented to show this difference : one knowing the weights and following a fast path, an other following a path longer without knowing it's a longer path.</p>
<p>Code of the model : </p>
<pre><code class="hljs processing">
model weightperagents

global {
    <span class="hljs-built_in">map</span>&lt;road, <span class="hljs-built_in">float</span>&gt; roads_weight;
    graph road_network;
    <span class="hljs-built_in">float</span> slow_coeff &lt;- <span class="hljs-number">3.0</span>;
    init {
        <span class="hljs-comment">//This road will be slow</span>
        create road {
            <span class="hljs-built_in">shape</span> &lt;- <span class="hljs-built_in">line</span> ([{<span class="hljs-number">10</span>,<span class="hljs-number">50</span>},{<span class="hljs-number">90</span>,<span class="hljs-number">50</span>}]);
            slow &lt;- <span class="hljs-keyword">true</span>;
        }
        <span class="hljs-comment">//The others will be faster</span>
        create road {
            <span class="hljs-built_in">shape</span> &lt;- <span class="hljs-built_in">line</span> ([{<span class="hljs-number">10</span>,<span class="hljs-number">50</span>},{<span class="hljs-number">10</span>,<span class="hljs-number">10</span>}]);
            slow &lt;- <span class="hljs-keyword">false</span>;
        }
        create road {
            <span class="hljs-built_in">shape</span> &lt;- <span class="hljs-built_in">line</span> ([{<span class="hljs-number">10</span>,<span class="hljs-number">10</span>},{<span class="hljs-number">90</span>,<span class="hljs-number">10</span>}]);
            slow &lt;- <span class="hljs-keyword">false</span>;
        }
        create road {
            <span class="hljs-built_in">shape</span> &lt;- <span class="hljs-built_in">line</span> ([{<span class="hljs-number">90</span>,<span class="hljs-number">10</span>},{<span class="hljs-number">90</span>,<span class="hljs-number">50</span>}]);
            slow &lt;- <span class="hljs-keyword">false</span>;
        }
        
        <span class="hljs-comment">//Weights map of the graph for those who will know the shortest road by taking into account the weight of the edges</span>
        roads_weight &lt;- road as_map (each:: each.<span class="hljs-built_in">shape</span>.perimeter * (each.slow ? slow_coeff : <span class="hljs-number">1.0</span>));
        road_network &lt;- as_edge_graph(road);
        
        <span class="hljs-comment">//people with information about the traffic</span>
        create people {
            <span class="hljs-built_in">color</span> &lt;- #<span class="hljs-built_in">blue</span>;
            <span class="hljs-built_in">size</span> &lt;- <span class="hljs-number">2.0</span>;
            roads_knowledge &lt;- roads_weight;
        }
        
        <span class="hljs-comment">//people without information about the traffic</span>
        create people {
            <span class="hljs-built_in">color</span> &lt;- #yellow;
            <span class="hljs-built_in">size</span> &lt;- <span class="hljs-number">1.0</span>;
            roads_knowledge &lt;- road as_map (each:: each.<span class="hljs-built_in">shape</span>.perimeter);
        }
    }
    
}

species road {
    bool slow;
    aspect geom {
        <span class="hljs-title">draw</span> <span class="hljs-built_in">shape</span> <span class="hljs-built_in">color</span>: slow ? #<span class="hljs-built_in">red</span> : #<span class="hljs-built_in">green</span>;
    }
}
    
species people skills: [moving] {
    <span class="hljs-built_in">map</span>&lt;road, <span class="hljs-built_in">float</span>&gt; roads_knowledge;
    <span class="hljs-built_in">point</span> the_target;
    rgb <span class="hljs-built_in">color</span>;
    <span class="hljs-built_in">float</span> <span class="hljs-built_in">size</span>;
    path path_to_follow;
    
    init {
        the_target &lt;- {<span class="hljs-number">90</span>,<span class="hljs-number">50</span>};
        location &lt;- {<span class="hljs-number">10</span>,<span class="hljs-number">50</span>};
    }
        
    reflex movement when: location != the_target{
        <span class="hljs-keyword">if</span> (path_to_follow = nil) {
            
            <span class="hljs-comment">//Find the shortest path using the agent's own weights to compute the shortest path</span>
            path_to_follow &lt;- path_between(road_network with_weights roads_knowledge, location,the_target);
        }
        <span class="hljs-comment">//the agent follows the path it computed but with the real weights of the graph</span>
        do follow path:path_to_follow speed: <span class="hljs-number">5</span> move_weights: roads_weight;
    }
        
    aspect base {
        <span class="hljs-title">draw</span> circle(<span class="hljs-built_in">size</span>) <span class="hljs-built_in">color</span>: <span class="hljs-built_in">color</span>;
    }
}

experiment weightperagents type: gui {
    <span class="hljs-built_in">float</span> minimum_cycle_duration &lt;- <span class="hljs-number">0.1</span>;
    output {
        display <span class="hljs-built_in">map</span> {
            species road aspect: geom;
            species people aspect: base;
        }
    }
}
</code></pre>
<script>hljs.initHighlightingOnLoad();</script></body></html>