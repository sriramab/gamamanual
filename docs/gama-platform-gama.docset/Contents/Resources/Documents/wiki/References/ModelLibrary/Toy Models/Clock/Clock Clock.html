<html><!-- Online page at https://github.com/gama-platform/gama/wiki/References/ModelLibrary/Toy Models/Clock/Clock Clock --><head><meta charset="utf-8"><title>Clock Clock</title><script src="../../../../../dash_resources/highlight.all.js"></script><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/github-markdown.css"><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/highlightjs.github.css"></head><body class="markdown-body" style="padding-bottom:20px; margin: 8px 13px;"><h1 id="clock-clock">Clock Clock</h1>
<h1 id="clock">Clock</h1>
<p>_Author : JD _</p>
<p>Code of the model : </p>
<pre><code class="hljs processing">model Clock

global {
    <span class="hljs-comment">//Background of the clock</span>
    file clock_normal     <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- image_file(<span class="hljs-string">"../images/clock.png"</span>);
    <span class="hljs-comment">//Image for the big hand </span>
    file clock_big_hand   <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- image_file(<span class="hljs-string">"../images/big_hand.png"</span>);
    <span class="hljs-comment">//Image for the small hand</span>
    file clock_small_hand <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- image_file(<span class="hljs-string">"../images/small_hand.png"</span>);
    <span class="hljs-comment">//Image for the clock alarm</span>
    file clock_alarm      <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- image_file(<span class="hljs-string">"../images/alarm_hand.png"</span>);
    <span class="hljs-comment">//Zoom to take in consideration the zoom in the display, to better write the cycle values</span>
    <span class="hljs-built_in">int</span> zoom &lt;- <span class="hljs-number">4</span> <span class="hljs-built_in">min</span>:<span class="hljs-number">1</span> <span class="hljs-built_in">max</span>:<span class="hljs-number">100</span>;
    <span class="hljs-comment">//Time value for a cycle</span>
    <span class="hljs-built_in">float</span> step&lt;<span class="hljs-number">-360000.0</span>#ms <span class="hljs-built_in">min</span>: <span class="hljs-number">1.0</span> <span class="hljs-built_in">max</span>: <span class="hljs-number">360000.0</span>;
    
    <span class="hljs-comment">//Alarm parameters</span>
    <span class="hljs-built_in">int</span> alarm_days &lt;- <span class="hljs-number">0</span> <span class="hljs-built_in">min</span>:<span class="hljs-number">0</span> <span class="hljs-built_in">max</span>:<span class="hljs-number">365</span>;
    <span class="hljs-built_in">int</span> alarm_hours &lt;- <span class="hljs-number">2</span> <span class="hljs-built_in">min</span>:<span class="hljs-number">0</span> <span class="hljs-built_in">max</span>:<span class="hljs-number">11</span>;
    <span class="hljs-built_in">int</span> alarm_minutes &lt;- <span class="hljs-number">0</span> <span class="hljs-built_in">min</span>:<span class="hljs-number">0</span> <span class="hljs-built_in">max</span>:<span class="hljs-number">59</span>;
    <span class="hljs-built_in">int</span> alarm_seconds &lt;- <span class="hljs-number">0</span> <span class="hljs-built_in">min</span>:<span class="hljs-number">0</span> <span class="hljs-built_in">max</span>:<span class="hljs-number">59</span>;
    bool alarm_am &lt;- <span class="hljs-keyword">true</span>;
    <span class="hljs-built_in">int</span> alarmCycle &lt;-  <span class="hljs-built_in">int</span>((alarm_seconds+alarm_minutes*<span class="hljs-number">60</span>+alarm_hours*<span class="hljs-number">3600</span> + (alarm_am ? <span class="hljs-number">0</span> : <span class="hljs-number">3600</span>*<span class="hljs-number">12</span>) + alarm_days*<span class="hljs-number">3600</span>*<span class="hljs-number">24</span>) * <span class="hljs-number">1000</span> / step);
    
    <span class="hljs-comment">//Time elapsed since the beginning of the experiment</span>
    <span class="hljs-built_in">int</span> timeElapsed &lt;- <span class="hljs-number">0</span> update:  <span class="hljs-built_in">int</span>(cycle * step);
    string reflexType &lt;-<span class="hljs-string">""</span>;
    init {
        <span class="hljs-comment">//Creation of the clock</span>
        create clock number: <span class="hljs-number">1</span> {
            location &lt;- {world.<span class="hljs-built_in">shape</span>.<span class="hljs-built_in">width</span>/<span class="hljs-number">5</span>,world.<span class="hljs-built_in">shape</span>.<span class="hljs-built_in">height</span>/<span class="hljs-number">5</span>};
        }
    }
}
<span class="hljs-comment">//Species that will represent the clock</span>
species  clock { 
        <span class="hljs-built_in">float</span> nb_minutes&lt;<span class="hljs-number">-0.0</span> update: ((timeElapsed mod <span class="hljs-number">3600000</span>#ms))/<span class="hljs-number">60000</span>#ms; <span class="hljs-comment">//Mod with 60 minutes or 1 hour, then divided by one minute value to get the number of minutes</span>
        <span class="hljs-built_in">float</span> nb_hours&lt;<span class="hljs-number">-0.0</span> update:((timeElapsed mod <span class="hljs-number">43200000</span>#ms))/<span class="hljs-number">3600000</span>#ms;
        reflex update {
            write string(nb_hours)+<span class="hljs-string">" : "</span>+nb_minutes;
            <span class="hljs-keyword">if</span> (cycle = alarmCycle) 
            {
                 write <span class="hljs-string">"Time to leave"</span> ; 

                 <span class="hljs-comment">// Uncomment the following statement to play the Alarm.mp3</span>
                 <span class="hljs-comment">// But firstly, you need to go to "Help -&gt; Install New Software..." to install the "Audio" feature (which is still in the experimental stage). </span>
                <span class="hljs-comment">//start_sound source:"../includes/Alarm.mp3" ;</span>
            }
        }
        aspect <span class="hljs-keyword">default</span> {
            <span class="hljs-title">draw</span> string(<span class="hljs-string">"#cycles: "</span> + cycle + <span class="hljs-string">" cycles"</span>)  <span class="hljs-built_in">size</span>:zoom/<span class="hljs-number">2</span> font:<span class="hljs-string">"times"</span> <span class="hljs-built_in">color</span>:Â°black at:{world.<span class="hljs-built_in">shape</span>.<span class="hljs-built_in">width</span>/<span class="hljs-number">3</span>,<span class="hljs-number">0</span>};
            <span class="hljs-title">draw</span> clock_big_hand <span class="hljs-built_in">rotate</span>: nb_minutes*(<span class="hljs-number">360</span>/<span class="hljs-number">60</span>)  + <span class="hljs-number">90</span>  <span class="hljs-built_in">size</span>: {<span class="hljs-number">7</span> * zoom, <span class="hljs-number">2</span>}; <span class="hljs-comment">//Modulo with the representation of a minute in ms and divided by 10000 to get the degree of rotation</span>
            <span class="hljs-title">draw</span> clock_small_hand <span class="hljs-built_in">rotate</span>: nb_hours*(<span class="hljs-number">360</span>/<span class="hljs-number">12</span>)  + <span class="hljs-number">90</span>  <span class="hljs-built_in">size</span>:{<span class="hljs-number">5</span>*zoom, <span class="hljs-number">2</span>} ;           
            <span class="hljs-title">draw</span> clock_alarm <span class="hljs-built_in">rotate</span>:      (alarmCycle/<span class="hljs-number">12000</span>)  <span class="hljs-built_in">size</span>: zoom/<span class="hljs-number">3</span> ; <span class="hljs-comment">// Alarm time</span>
        }
 
}

experiment Display type: gui {
    <span class="hljs-built_in">float</span> minimum_cycle_duration &lt;- <span class="hljs-number">0.1</span>#s;
    parameter <span class="hljs-string">'Zoom: '</span> var: zoom category: <span class="hljs-string">'Init'</span> ;
    parameter <span class="hljs-string">'Milliseconds/cycle'</span> var: step category: <span class="hljs-string">'Init'</span>;
    parameter <span class="hljs-string">'alarm Day'</span> var: alarm_days;
    parameter <span class="hljs-string">'alarm Hour'</span> var: alarm_hours;
    parameter <span class="hljs-string">'alarm Am'</span> var: alarm_am;
    parameter <span class="hljs-string">'alarm Minutes'</span> var: alarm_minutes;
    parameter <span class="hljs-string">'alarm Seconds'</span> var: alarm_seconds;
    output {
        display ClockView type: opengl { 
            graphics <span class="hljs-string">"c"</span> refresh: <span class="hljs-keyword">false</span> {<span class="hljs-title">draw</span> clock_normal <span class="hljs-built_in">size</span>: <span class="hljs-number">10</span>*zoom at:{world.<span class="hljs-built_in">shape</span>.<span class="hljs-built_in">width</span>/<span class="hljs-number">5</span>,world.<span class="hljs-built_in">shape</span>.<span class="hljs-built_in">height</span>/<span class="hljs-number">5</span>} ;}
            species clock ;
        }
    }

}
</code></pre>
<script>hljs.initHighlightingOnLoad();</script></body></html>