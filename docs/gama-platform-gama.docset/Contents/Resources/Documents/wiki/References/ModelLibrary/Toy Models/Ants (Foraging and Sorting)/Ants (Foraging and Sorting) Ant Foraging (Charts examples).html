<html><!-- Online page at https://github.com/gama-platform/gama/wiki/References/ModelLibrary/Toy Models/Ants (Foraging and Sorting)/Ants (Foraging and Sorting) Ant Foraging (Charts examples) --><head><meta charset="utf-8"><title>Ants (Foraging and Sorting) Ant Foraging (Charts examples)</title><script src="../../../../../dash_resources/highlight.all.js"></script><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/github-markdown.css"><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/highlightjs.github.css"></head><body class="markdown-body" style="padding-bottom:20px; margin: 8px 13px;"><h1 id="ants-foraging-and-sorting-ant-foraging-charts-examples">Ants (Foraging and Sorting) Ant Foraging (Charts examples)</h1>
<h1 id="ant-foraging-charts-examples">Ant Foraging (Charts examples)</h1>
<p>_Author : _</p>
<p>Toy Model ant using the question of how ants search food and use pheromons to return to their nest once they did find food. In this model, the charts are particularly used.</p>
<p>![F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\Ants-10.png](F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\Ants-10.png)</p>
<p>![F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartHisto-10.png](F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartHisto-10.png)</p>
<p>![F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartHistoList-10.png](F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartHistoList-10.png)</p>
<p>![F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartHistoListList-10.png](F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartHistoListList-10.png)</p>
<p>![F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartPie-10.png](F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartPie-10.png)</p>
<p>![F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartPieList-10.png](F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartPieList-10.png)</p>
<p>![F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartScatter-10.png](F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartScatter-10.png)</p>
<p>![F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartScatterHistory-10.png](F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartScatterHistory-10.png)</p>
<p>![F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartScatterList-10.png](F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartScatterList-10.png)</p>
<p>![F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartSerie-10.png](F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartSerie-10.png)</p>
<p>![F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartSerieList-10.png](F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartSerieList-10.png)</p>
<p>![F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartSeriesListList-10.png](F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\ChartSeriesListList-10.png)</p>
<p>![F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\Cyclevalues-10.png](F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\Cyclevalues-10.png)</p>
<p>![F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\Dispscaleoption-10.png](F:\Gama\GamaWiki\resources\images\modelLibraryScreenshots\Toy Models\Ants (Foraging and Sorting)\Ants (Foraging and Sorting) Ant Foraging (Charts examples)\Dispscaleoption-10.png)</p>
<p>Code of the model : </p>
<pre><code class="hljs gradle">model ants

global {
    <span class="hljs-comment">//Number of ants</span>
    <span class="hljs-keyword">int</span> ants_number &lt;- <span class="hljs-number">100</span> min: <span class="hljs-number">1</span> max: <span class="hljs-number">2000</span> ;
    <span class="hljs-comment">//Evaporation value per cycle for the pheromons</span>
    <span class="hljs-keyword">float</span> evaporation_per_cycle &lt;- <span class="hljs-number">5.0</span> min: <span class="hljs-number">0.0</span> max: <span class="hljs-number">240.0</span> ;
    <span class="hljs-comment">//Diffusion rate for the pheromons</span>
    <span class="hljs-keyword">float</span> diffusion_rate &lt;- <span class="hljs-number">1.0</span> min: <span class="hljs-number">0.0</span> max: <span class="hljs-number">1.0</span> ;
    bool use_icons &lt;- <span class="hljs-keyword">true</span> ;
    bool display_state &lt;- <span class="hljs-keyword">true</span>;
    <span class="hljs-comment">//Size of the grid</span>
    <span class="hljs-keyword">int</span> gridsize &lt;- <span class="hljs-number">75</span> ;
    <span class="hljs-comment">//Center of the grid to put the location of the nest</span>
    const center type: point &lt;- { (gridsize <span class="hljs-regexp">/ 2),  (gridsize /</span> <span class="hljs-number">2</span>)} ;
    const types type: <span class="hljs-keyword">file</span> &lt;- (pgm_file(<span class="hljs-string">'../images/environment75x75.pgm'</span>)) ;
    const ant_shape_empty type: string &lt;- <span class="hljs-string">'../icons/ant.png'</span> ;
    const ant_shape_full type: string &lt;- <span class="hljs-string">'../icons/full_ant.png'</span>  ;
    const C00CC00 type: rgb &lt;- rgb(<span class="hljs-string">'#00CC00'</span>) ;    
    const C009900 type: rgb &lt;- rgb(<span class="hljs-string">'#009900'</span>) ; 
    const C005500 type: rgb &lt;- rgb(<span class="hljs-string">'#005500'</span>) ; 
    <span class="hljs-keyword">int</span> food_gathered &lt;- <span class="hljs-number">0</span> ;   
    geometry shape &lt;- square(gridsize);
    init{  
        <span class="hljs-comment">//Ant are placed randomly in the nest</span>
        create <span class="hljs-keyword">ant</span> number: ants_number with: [location::any_location_in (ant_grid(center))] ;
    }
    
    <span class="hljs-comment">//Reflex to diffuse the road of pheromon on the grid</span>
    reflex diffuse {
      diffuse var:road on:ant_grid proportion: diffusion_rate radius:<span class="hljs-number">2</span> propagation: gradient;
   }

}

<span class="hljs-comment">//Grid to discretize space for the food and the nest</span>
grid ant_grid width: gridsize height: gridsize neighbors: <span class="hljs-number">8</span> use_regular_agents: <span class="hljs-keyword">false</span> {
    bool multiagent &lt;- <span class="hljs-keyword">true</span> ;
    <span class="hljs-keyword">float</span> road &lt;- <span class="hljs-number">0.0</span> max:<span class="hljs-number">240.0</span> update: (road&lt;=evaporation_per_cycle) ? <span class="hljs-number">0.0</span> : road-evaporation_per_cycle;
    <span class="hljs-keyword">int</span> type &lt;- <span class="hljs-keyword">int</span>(types at {grid_x,grid_y}) ;
    bool isNestLocation &lt;- (self distance_to center) &lt; <span class="hljs-number">4</span> ; 
    bool isFoodLocation &lt;- type = <span class="hljs-number">2</span> ; 
    rgb color &lt;- isNestLocation ? °violet:((food &gt; <span class="hljs-number">0</span>)? °blue : ((road &lt; <span class="hljs-number">0.001</span>)? rgb ([<span class="hljs-number">100</span>,<span class="hljs-number">100</span>,<span class="hljs-number">100</span>]) : ((road &gt; <span class="hljs-number">2</span>)? °white : ((road &gt; <span class="hljs-number">0.5</span>)? (C00CC00) : ((road &gt; <span class="hljs-number">0.2</span>)? (C009900) : (C005500)))))) update: isNestLocation ? °violet:((food &gt; <span class="hljs-number">0</span>)? °blue : ((road &lt; <span class="hljs-number">0.001</span>)? rgb ([<span class="hljs-number">100</span>,<span class="hljs-number">100</span>,<span class="hljs-number">100</span>]) : ((road &gt; <span class="hljs-number">2</span>)? °white : ((road &gt; <span class="hljs-number">0.5</span>)? (C00CC00) : ((road &gt; <span class="hljs-number">0.2</span>)? (C009900) : (C005500)))))) ;
    <span class="hljs-keyword">int</span> food &lt;- isFoodLocation ? <span class="hljs-number">5</span> : <span class="hljs-number">0</span> ;
    const nest type: <span class="hljs-keyword">int</span> &lt;- <span class="hljs-number">300</span> - <span class="hljs-keyword">int</span>(self distance_to center) ;
    
}
<span class="hljs-comment">//Species ant that will move and follow a final state machine</span>
species <span class="hljs-keyword">ant</span> skills: [moving] control: fsm {
    <span class="hljs-keyword">float</span> speed &lt;- <span class="hljs-number">2.0</span> ;
    ant_grid place update: ant_grid (location ); 
    string im &lt;- <span class="hljs-string">'ant_shape_empty'</span> ;
    bool hasFood &lt;- <span class="hljs-keyword">false</span> ;
    reflex diffuse_road when:hasFood=<span class="hljs-keyword">true</span>{
      ant_grid(location).road &lt;- ant_grid(location).road + <span class="hljs-number">100.0</span>;
   }
   <span class="hljs-comment">//Action to pick food</span>
    action pick {
        im &lt;- ant_shape_full ;
        hasFood &lt;- <span class="hljs-keyword">true</span> ;
        place.food &lt;- place.food - <span class="hljs-number">1</span> ;
    }
    <span class="hljs-comment">//Action to drop food</span>
    action drop {
        food_gathered &lt;- food_gathered + <span class="hljs-number">1</span> ;
        hasFood &lt;- <span class="hljs-keyword">false</span> ;
        heading &lt;- heading - <span class="hljs-number">180</span> ;
    }
    <span class="hljs-comment">//Action to chose the best place according to the possible food in the neighbour cells</span>
    action choose_best_place type: ant_grid {
        list&lt;ant_grid&gt; list_places &lt;- place.neighbors ;
        <span class="hljs-keyword">if</span> (list_places <span class="hljs-keyword">count</span> (<span class="hljs-keyword">each</span>.food &gt; <span class="hljs-number">0</span>)) &gt; <span class="hljs-number">0</span>  {
            <span class="hljs-keyword">return</span> (list_places first_with (<span class="hljs-keyword">each</span>.food &gt; <span class="hljs-number">0</span>)) ;
        } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">int</span> min_nest  &lt;-  (list_places min_of (<span class="hljs-keyword">each</span>.nest)) ;
                list_places &lt;- list_places <span class="hljs-keyword">sort</span> ((<span class="hljs-keyword">each</span>.nest = min_nest) ? <span class="hljs-keyword">each</span>.road :  <span class="hljs-number">0.0</span>) ;
                <span class="hljs-keyword">return</span> last(list_places) ;
            }
    }
    
    <span class="hljs-comment">//Initial state of the ant : wander until it finds food or find a road to follow</span>
    state wandering initial: <span class="hljs-keyword">true</span> {
        <span class="hljs-keyword">do</span> wander amplitude:<span class="hljs-number">120</span> ;
        transition to: carryingFood when: place.food &gt; <span class="hljs-number">0</span> {
            <span class="hljs-keyword">do</span> pick ;
        }
        transition to: followingRoad when: place.road &gt; <span class="hljs-number">0.05</span> ;
    }
    <span class="hljs-comment">//State to carry food to the nest once the food is found</span>
    state carryingFood {
        <span class="hljs-keyword">do</span> goto target: center ;
        transition to: wandering when: place.isNestLocation { 
            <span class="hljs-keyword">do</span> drop ;
        }
    }
    <span class="hljs-comment">//State to follow a road </span>
    state followingRoad {
        location &lt;- (self choose_best_place []) as point ;
        transition to: carryingFood when: place.food &gt; <span class="hljs-number">0</span> {
            <span class="hljs-keyword">do</span> pick ;
        }
        transition to: wandering when: (place.road &lt; <span class="hljs-number">0.05</span>) ;
    }
    aspect text {
        <span class="hljs-keyword">if</span> use_icons {
            draw  hasFood ? <span class="hljs-keyword">file</span>(ant_shape_full) : <span class="hljs-keyword">file</span>(ant_shape_empty) rotate: heading at: location <span class="hljs-keyword">size</span>: {<span class="hljs-number">7</span>,<span class="hljs-number">5</span>} ;
        } <span class="hljs-keyword">else</span> {
            draw circle(<span class="hljs-number">1.0</span>) empty: !hasFood color: rgb (<span class="hljs-string">'orange'</span>) ;
        }
        <span class="hljs-keyword">if</span> display_state {
            draw state at: location + {-<span class="hljs-number">3</span>,<span class="hljs-number">1.5</span>} color: °white <span class="hljs-keyword">size</span>: <span class="hljs-number">0.8</span> ;
        }
    }
    aspect <span class="hljs-keyword">default</span> {
        draw circle(<span class="hljs-number">1.0</span>) empty: !hasFood color: #orange ; 
    }
}
experiment <span class="hljs-keyword">Ant</span> type: gui {
    <span class="hljs-comment">//Parameters to play with  in the gui</span>
    parameter <span class="hljs-string">'Number of ants:'</span> var: ants_number category: <span class="hljs-string">'Model'</span> ;
    parameter <span class="hljs-string">'Evaporation of the signal (unit/cycle):'</span> var: evaporation_per_cycle category: <span class="hljs-string">'Model'</span> ;
    parameter <span class="hljs-string">'Rate of diffusion of the signal (%/cycle):'</span> var: diffusion_rate category: <span class="hljs-string">'Model'</span> ;
    parameter <span class="hljs-string">'Use icons for the agents:'</span> var: use_icons category: <span class="hljs-string">'Display'</span> ;
    parameter <span class="hljs-string">'Display state of agents:'</span> var: display_state category: <span class="hljs-string">'Display'</span> ;

    list&lt;list&lt;<span class="hljs-keyword">int</span>&gt;&gt; nbants&lt;-[[<span class="hljs-number">0</span>]];
    list&lt;string&gt; statesnames&lt;-[<span class="hljs-string">""</span>];
    list&lt;string&gt; categnames&lt;-[<span class="hljs-string">"empty"</span>,<span class="hljs-string">"carry"</span>];
    list&lt;list&lt;<span class="hljs-keyword">int</span>&gt;&gt; nbantsbydist&lt;-[[<span class="hljs-number">0</span>]];
    list xytestvallist&lt;-[[[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">3</span>]],[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]],[[<span class="hljs-number">1</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]],[[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]]];
    list&lt;list&lt;<span class="hljs-keyword">int</span>&gt;&gt; xyval&lt;-[[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">2</span>]];
    
    <span class="hljs-comment">//Reflex to update the charts, belonging to the experiment bloc as it will not be used by other experiment which don't have the charts</span>
    reflex update_charts
    {
        nbants&lt;-[];
        statesnames&lt;-[];
        categnames&lt;-[<span class="hljs-string">"empty"</span>,<span class="hljs-string">"carry"</span>];
        nbantsbydist&lt;-[];
        <span class="hljs-keyword">ant</span> x&lt;-one_of(world.<span class="hljs-keyword">ant</span>);
        loop x over:list(world.<span class="hljs-keyword">ant</span>)
        {
            <span class="hljs-keyword">if</span> !(statesnames contains (x.state))
            {               
            add [(list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (<span class="hljs-keyword">each</span>.state=x.state and !<span class="hljs-keyword">each</span>.hasFood)),(list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (<span class="hljs-keyword">each</span>.state=x.state and <span class="hljs-keyword">each</span>.hasFood))] to: nbants;
            add (x.state) to:statesnames;               
            <span class="hljs-keyword">int</span> d&lt;-<span class="hljs-number">0</span>;
            list&lt;<span class="hljs-keyword">int</span>&gt; nl&lt;-[];
            loop d <span class="hljs-keyword">from</span>:<span class="hljs-number">0</span> to:<span class="hljs-number">9</span>
                {
            add (list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (<span class="hljs-keyword">each</span>.state=x.state and (((<span class="hljs-keyword">each</span> distance_to center)&gt;gridsize<span class="hljs-regexp">/20*d) and ((each distance_to center)&lt;gridsize/</span><span class="hljs-number">20</span>*(d+<span class="hljs-number">1</span>))))) to: nl;
                }
            add nl to:nbantsbydist;
            }
<span class="hljs-comment">//          add length((list(world.ant) collect (each.next_place distance_to each.location)) where (each=x)) to:nbants;</span>
        }
        <span class="hljs-comment">//write("nbants"+nbants);</span>
        <span class="hljs-comment">//write("nbantsbydist"+nbantsbydist);</span>
        <span class="hljs-comment">//write("states"+statesnames);      </span>
    }
    <span class="hljs-comment">//The different displays</span>
    output {
        display Ants type: opengl {
            grid ant_grid ;
            species <span class="hljs-keyword">ant</span> aspect: text ;
        }
        display ChartPie {
            chart <span class="hljs-string">"DataPie"</span> type:pie
            {
                data <span class="hljs-string">"empty_ants"</span> value:(list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (!<span class="hljs-keyword">each</span>.hasFood)) color:°red;
                data <span class="hljs-string">"carry_food_ants"</span> value:(list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (<span class="hljs-keyword">each</span>.hasFood)) color:°green;
                
            }
            
            }
        display ChartPieList {
            chart <span class="hljs-string">"DataListPie"</span> type:pie style:exploded
            {
                datalist [<span class="hljs-string">"empty"</span>,<span class="hljs-string">"carry"</span>] value:[(list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (!<span class="hljs-keyword">each</span>.hasFood)),(list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (<span class="hljs-keyword">each</span>.hasFood))] color:[°red,°green];              
            }
        }
        display ChartHisto {
            chart <span class="hljs-string">"DataBar"</span> type:histogram
            {
                data <span class="hljs-string">"empty_ants"</span> value:(list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (!<span class="hljs-keyword">each</span>.hasFood)) color:°red;
                data <span class="hljs-string">"carry_food_ants"</span> value:(list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (<span class="hljs-keyword">each</span>.hasFood)) color:°green;             
            }
            
            }
        display ChartHistoList {
            chart <span class="hljs-string">"DataListBar"</span> type:histogram style:<span class="hljs-string">"3d"</span>
            {
                datalist [<span class="hljs-string">"empty"</span>,<span class="hljs-string">"carry"</span>] value:[(list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (!<span class="hljs-keyword">each</span>.hasFood)),(list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (<span class="hljs-keyword">each</span>.hasFood))] color:[°red,°green];              
            }
        }
        display ChartHistoListList {
            chart <span class="hljs-string">"DataListListBar"</span> type:histogram
            {
                datalist categoriesnames:categnames  value:nbants legend:statesnames inverse_series_categories :<span class="hljs-keyword">false</span> style:stack;
            }
        }
        display ChartSerie {
            chart <span class="hljs-string">"DataSeries"</span> type:series
            {
                data <span class="hljs-string">"empty_ants"</span> value:<span class="hljs-keyword">float</span>((list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (!<span class="hljs-keyword">each</span>.hasFood))) color:°red;
                data <span class="hljs-string">"carry_food_ants"</span> value:<span class="hljs-keyword">float</span>((list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (<span class="hljs-keyword">each</span>.hasFood))) color:°green;
                
            }
            
            }

        display Dispscaleoption
        {
            chart <span class="hljs-string">"simpleserieslist"</span> type:series  y_range:{-<span class="hljs-number">6.11</span>, -<span class="hljs-number">4.11</span>} x_tick_unit:<span class="hljs-number">0.5</span> y_tick_unit:<span class="hljs-number">0.05</span>
            {
                data value:[-<span class="hljs-number">5</span>,-<span class="hljs-number">6</span>,-<span class="hljs-number">8</span>] legend:<span class="hljs-string">"prems"</span> color:°blue marker_shape:marker_square fill:<span class="hljs-keyword">false</span>;
                data value:[-<span class="hljs-number">5.5</span>,-<span class="hljs-number">4.11</span>,-<span class="hljs-number">5.645</span>] legend:<span class="hljs-string">"sec"</span> color:°red marker_shape:marker_empty;
                data value:[-<span class="hljs-number">7</span>,-<span class="hljs-number">6</span>,-<span class="hljs-number">4.654</span>] legend:<span class="hljs-string">"third"</span> color:°green marker_shape:marker_hor_ellipse fill:<span class="hljs-keyword">false</span>;
            }
        }
        display Cyclevalues
        {
            chart <span class="hljs-string">"simplecyclelist"</span> type:xy x_tick_unit:<span class="hljs-number">0.5</span> y_tick_unit:<span class="hljs-number">0.5</span>
            {
                data value:{-<span class="hljs-number">5</span>+cycle,-<span class="hljs-number">4</span>} legend:<span class="hljs-string">"prems"</span> color:°blue marker_shape:marker_square fill:<span class="hljs-keyword">false</span>;
                data value:{-<span class="hljs-number">5.5</span>+cycle,-<span class="hljs-number">3.5</span>} legend:<span class="hljs-string">"sec"</span> color:°red marker_shape:marker_diamond;
                data value:{-<span class="hljs-number">7</span>+cycle,-<span class="hljs-number">4.654</span>} legend:<span class="hljs-string">"third"</span> color:°green marker_shape:marker_hor_ellipse fill:<span class="hljs-keyword">false</span>;
            }
        }
            display ChartSerieList {
            chart <span class="hljs-string">"DataListSeries"</span> type:series
            {
                datalist [<span class="hljs-string">"food"</span>,<span class="hljs-string">"empty"</span>] value:[(list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (<span class="hljs-keyword">each</span>.hasFood)),(list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (!<span class="hljs-keyword">each</span>.hasFood))] color:[°purple,°black] style:area;             
            }
        }
        display ChartSeriesListList {
            chart <span class="hljs-string">"DataListListSeries"</span> type:series
            {
                datalist categoriesnames:categnames  value:nbants legend:statesnames inverse_series_categories :<span class="hljs-keyword">false</span> style:line;
            }
        }
        display ChartScatter {
            chart <span class="hljs-string">"DataScatter"</span> type:scatter
            {
                data <span class="hljs-string">"empty_ants"</span> value:((list(<span class="hljs-keyword">ant</span>) where (!<span class="hljs-keyword">each</span>.hasFood)) <span class="hljs-keyword">collect</span> <span class="hljs-keyword">each</span>.location) color:°red line_visible:<span class="hljs-keyword">false</span>;
                data <span class="hljs-string">"carry_food_ants"</span> value:((list(<span class="hljs-keyword">ant</span>) where (<span class="hljs-keyword">each</span>.hasFood)) <span class="hljs-keyword">collect</span> <span class="hljs-keyword">each</span>.location) color:°green line_visible:<span class="hljs-keyword">false</span>;
                
            }
            
            }
        display ChartScatterList {
            chart <span class="hljs-string">"DataListScatter"</span> type:scatter
            {
                datalist [<span class="hljs-string">"empty"</span>,<span class="hljs-string">"carry"</span>] value:[((list(<span class="hljs-keyword">ant</span>) where (!<span class="hljs-keyword">each</span>.hasFood))  <span class="hljs-keyword">collect</span> <span class="hljs-keyword">each</span>.location),((list(<span class="hljs-keyword">ant</span>) where (<span class="hljs-keyword">each</span>.hasFood))  <span class="hljs-keyword">collect</span> <span class="hljs-keyword">each</span>.location)] color:[°red,°green] line_visible:<span class="hljs-keyword">false</span>;             
            }
        }
        display ChartScatterHistory {
            chart <span class="hljs-string">"DataListScatterHistory"</span> type:scatter
            {
                datalist [<span class="hljs-string">"empty"</span>,<span class="hljs-string">"carry"</span>] value:[mean((list(<span class="hljs-keyword">ant</span>) where (!<span class="hljs-keyword">each</span>.hasFood)) <span class="hljs-keyword">collect</span> <span class="hljs-keyword">each</span>.location),mean((list(<span class="hljs-keyword">ant</span>) where (<span class="hljs-keyword">each</span>.hasFood)) <span class="hljs-keyword">collect</span> <span class="hljs-keyword">each</span>.location)]
                     color:[°red,°green] line_visible:<span class="hljs-keyword">true</span>;             
            }
        }   
        }
    
    }
    
<span class="hljs-comment">//Experiment with only two display : the grid and the ants, and a chart</span>
experiment AntOneDisp type: gui {
    parameter <span class="hljs-string">'Number of ants:'</span> var: ants_number category: <span class="hljs-string">'Model'</span> ;
    parameter <span class="hljs-string">'Evaporation of the signal unit/cycle):'</span> var: evaporation_per_cycle category: <span class="hljs-string">'Model'</span> ;
    parameter <span class="hljs-string">'Rate of diffusion of the signal (%/cycle):'</span> var: diffusion_rate category: <span class="hljs-string">'Model'</span> ;
    parameter <span class="hljs-string">'Use icons for the agents:'</span> var: use_icons category: <span class="hljs-string">'Display'</span> ;
    parameter <span class="hljs-string">'Display state of agents:'</span> var: display_state category: <span class="hljs-string">'Display'</span> ;

    list&lt;list&lt;<span class="hljs-keyword">int</span>&gt;&gt; nbants&lt;-[[<span class="hljs-number">0</span>]];
    list&lt;string&gt; statesnames&lt;-[<span class="hljs-string">""</span>];
    list&lt;string&gt; categnames&lt;-[<span class="hljs-string">"empty"</span>,<span class="hljs-string">"carry"</span>];
    list&lt;list&lt;<span class="hljs-keyword">int</span>&gt;&gt; nbantsbydist&lt;-[[<span class="hljs-number">0</span>]];
    list xytestvallist&lt;-[[[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">3</span>]],[[<span class="hljs-number">1</span>,<span class="hljs-number">2</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">4</span>]],[[<span class="hljs-number">1</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">3</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>]],[[<span class="hljs-number">1</span>,<span class="hljs-number">4</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">5</span>],[<span class="hljs-number">0</span>,<span class="hljs-number">0</span>]]];
    list&lt;list&lt;<span class="hljs-keyword">int</span>&gt;&gt; xyval&lt;-[[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">2</span>,<span class="hljs-number">1</span>],[<span class="hljs-number">3</span>,<span class="hljs-number">2</span>]];

    reflex update_charts
    {
        <span class="hljs-keyword">ant</span> x&lt;-one_of(world.<span class="hljs-keyword">ant</span>);
        loop x over:list(world.<span class="hljs-keyword">ant</span>)
        {
            <span class="hljs-keyword">if</span> !(statesnames contains (x.state))
            {               
            add [(list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (<span class="hljs-keyword">each</span>.state=x.state and !<span class="hljs-keyword">each</span>.hasFood)),(list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (<span class="hljs-keyword">each</span>.state=x.state and <span class="hljs-keyword">each</span>.hasFood))] to: nbants;
            add (x.state) to:statesnames;               
            <span class="hljs-keyword">int</span> d&lt;-<span class="hljs-number">0</span>;
            list&lt;<span class="hljs-keyword">int</span>&gt; nl&lt;-[];
            loop d <span class="hljs-keyword">from</span>:<span class="hljs-number">0</span> to:<span class="hljs-number">9</span>
                {
            add (list(<span class="hljs-keyword">ant</span>) <span class="hljs-keyword">count</span> (<span class="hljs-keyword">each</span>.state=x.state and (((<span class="hljs-keyword">each</span> distance_to center)&gt;gridsize<span class="hljs-regexp">/20*d) and ((each distance_to center)&lt;gridsize/</span><span class="hljs-number">20</span>*(d+<span class="hljs-number">1</span>))))) to: nl;
                }
            add nl to:nbantsbydist;
            }
        }
        <span class="hljs-keyword">write</span>(<span class="hljs-string">"nbants"</span>+nbants);
        <span class="hljs-keyword">write</span>(<span class="hljs-string">"nbantsbydist"</span>+nbantsbydist);
        <span class="hljs-keyword">write</span>(<span class="hljs-string">"states"</span>+statesnames);        
    }
    output {
        display Ants type: opengl {
            grid ant_grid ;
            species <span class="hljs-keyword">ant</span> aspect: text ;
        }

        display ChartSerieList {
            chart <span class="hljs-string">"DataListScatterHistory"</span> type:scatter
            {
                datalist [<span class="hljs-string">"empty"</span>,<span class="hljs-string">"carry"</span>] value:[mean((list(<span class="hljs-keyword">ant</span>) where (!<span class="hljs-keyword">each</span>.hasFood)) <span class="hljs-keyword">collect</span> <span class="hljs-keyword">each</span>.location),mean((list(<span class="hljs-keyword">ant</span>) where (<span class="hljs-keyword">each</span>.hasFood)) <span class="hljs-keyword">collect</span> <span class="hljs-keyword">each</span>.location)]
                     color:[°red,°green] line_visible:<span class="hljs-keyword">true</span>;             
            }
        }
    }
}

</code></pre>
<script>hljs.initHighlightingOnLoad();</script></body></html>