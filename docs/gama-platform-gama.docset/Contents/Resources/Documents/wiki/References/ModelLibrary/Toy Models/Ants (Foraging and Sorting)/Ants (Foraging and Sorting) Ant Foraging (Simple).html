<html><!-- Online page at https://github.com/gama-platform/gama/wiki/References/ModelLibrary/Toy Models/Ants (Foraging and Sorting)/Ants (Foraging and Sorting) Ant Foraging (Simple) --><head><meta charset="utf-8"><title>Ants (Foraging and Sorting) Ant Foraging (Simple)</title><script src="../../../../../dash_resources/highlight.all.js"></script><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/github-markdown.css"><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/highlightjs.github.css"></head><body class="markdown-body" style="padding-bottom:20px; margin: 8px 13px;"><h1 id="ants-foraging-and-sorting-ant-foraging-simple">Ants (Foraging and Sorting) Ant Foraging (Simple)</h1>
<h1 id="ant-foraging-simple">Ant Foraging (Simple)</h1>
<p>_Author : _</p>
<p>Toy Model ant using the question of how ants search food and use pheromons to return to their nest once they did find food. This model is the simple one.</p>
<p>Code of the model : </p>
<pre><code class="hljs zephir">model ants

<span class="hljs-keyword">global</span> {
    <span class="hljs-keyword">int</span> t &lt;- <span class="hljs-number">1</span>;
    <span class="hljs-comment">//Evaporation value per cycle of the pheromons</span>
    <span class="hljs-keyword">float</span> evaporation_per_cycle &lt;- <span class="hljs-number">5.0</span> min: <span class="hljs-number">0.01</span> max: <span class="hljs-number">240.0</span> ;
    <span class="hljs-comment">//Diffusion rate of the pheromons</span>
    <span class="hljs-keyword">float</span> diffusion_rate <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- <span class="hljs-number">1.0</span> min: <span class="hljs-number">0.0</span> max: <span class="hljs-number">1.0</span> ;
    <span class="hljs-comment">//Size of the grid</span>
    <span class="hljs-keyword">int</span> gridsize <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- <span class="hljs-number">75</span>; 
    <span class="hljs-comment">//Number of ants to create</span>
    <span class="hljs-keyword">int</span> ants_number  &lt;- <span class="hljs-number">50</span> min: <span class="hljs-number">1</span> max: <span class="hljs-number">200</span> parameter: <span class="hljs-string">'Number of Ants:'</span>;
    <span class="hljs-comment">//Variable to keep information about the food remaining</span>
    <span class="hljs-keyword">int</span> food_remaining update: <span class="hljs-keyword">list</span> ( ant_grid ) count ( each . food &gt; <span class="hljs-number">0</span>) &lt;- <span class="hljs-number">10</span>;
    <span class="hljs-comment">//Center of the grid that will be considered as the nest of ants</span>
    point center <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- { round ( gridsize / <span class="hljs-number">2</span> ) , round ( gridsize / <span class="hljs-number">2</span> ) };
    matrix&lt;<span class="hljs-keyword">int</span>&gt; types &lt;- matrix&lt;<span class="hljs-keyword">int</span>&gt; (pgm_file ( <span class="hljs-string">'../images/environment75x75_scarce.pgm'</span> )); 
    
    geometry shape &lt;- square(gridsize);
    
    init {
        <span class="hljs-comment">//Creation of the ants placed in the nest</span>
        create ant number: ants_number with: [ location :: center ];
    } 
    
    <span class="hljs-comment">//Different actions triggered by an user interaction</span>
    action press (point loc, <span class="hljs-keyword">list</span> selected_agents)
    {
        write(<span class="hljs-string">"press "</span> + loc.x + <span class="hljs-string">" "</span> + loc.y + <span class="hljs-string">" "</span>+selected_agents);
    }
    action release (point loc, <span class="hljs-keyword">list</span> selected_agents)
    {
        write(<span class="hljs-string">"release"</span>);
    }
    action click  (point loc, <span class="hljs-keyword">list</span> selected_agents)
    {
        write(<span class="hljs-string">"click"</span>);
    }
    action click2   (point loc, <span class="hljs-keyword">list</span> selected_agents)
    {
        write(<span class="hljs-string">"click2"</span>);
    }
    <span class="hljs-comment">//Reflex to diffuse the pheromons among the grid</span>
    reflex diffuse {
      diffuse <span class="hljs-keyword">var</span>:road on:ant_grid proportion: diffusion_rate radius:<span class="hljs-number">2</span> propagation: gradient;
   }

} 
<span class="hljs-comment">//Grid used to discretize space to place food in cells</span>
grid ant_grid width: gridsize height: gridsize neighbors: <span class="hljs-number">8</span> {
    <span class="hljs-keyword">bool</span> isNestLocation  &lt;- ( <span class="hljs-keyword">self</span> distance_to center ) &lt; <span class="hljs-number">4</span>;
    <span class="hljs-keyword">bool</span> isFoodLocation &lt;-  types[grid_x , grid_y] = <span class="hljs-number">2</span>;       
    <span class="hljs-keyword">list</span>&lt;ant_grid&gt; neighbours &lt;- <span class="hljs-keyword">self</span> neighbors_at <span class="hljs-number">1</span>;  
    <span class="hljs-keyword">float</span> road &lt;- <span class="hljs-number">0.0</span> max:<span class="hljs-number">240.0</span> update: (road&lt;=evaporation_per_cycle) ? <span class="hljs-number">0.0</span> : road-evaporation_per_cycle;
    rgb color &lt;- rgb([ <span class="hljs-keyword">self</span>.road &gt; <span class="hljs-number">15</span> ? <span class="hljs-number">255</span> : ( isNestLocation ? <span class="hljs-number">125</span> : <span class="hljs-number">0</span> ) , <span class="hljs-keyword">self</span>.road * <span class="hljs-number">30</span> , <span class="hljs-keyword">self</span>.road &gt; <span class="hljs-number">15</span> ? <span class="hljs-number">255</span> : food * <span class="hljs-number">50</span> ]) update: rgb([ <span class="hljs-keyword">self</span>.road &gt; <span class="hljs-number">15</span> ? <span class="hljs-number">255</span> : ( isNestLocation ? <span class="hljs-number">125</span> : <span class="hljs-number">0</span> ) ,<span class="hljs-keyword">self</span>.road * <span class="hljs-number">30</span> , <span class="hljs-keyword">self</span>.road &gt; <span class="hljs-number">15</span> ? <span class="hljs-number">255</span> : food * <span class="hljs-number">50</span> ]); 
    <span class="hljs-keyword">int</span> food &lt;- isFoodLocation ? <span class="hljs-number">5</span> : <span class="hljs-number">0</span>; 
    <span class="hljs-keyword">int</span> nest <span class="hljs-keyword">const</span>: <span class="hljs-keyword">true</span> &lt;- <span class="hljs-keyword">int</span>(<span class="hljs-number">300</span> - ( <span class="hljs-keyword">self</span> distance_to center ));
}

<span class="hljs-comment">//Species ant that will move</span>
species ant skills: [ moving ] {     
    rgb color &lt;- <span class="hljs-comment">#red;</span>
    ant_grid place <span class="hljs-function"><span class="hljs-keyword">function</span>: </span>{ant_grid ( location )};
    <span class="hljs-keyword">bool</span> hasFood &lt;- <span class="hljs-keyword">false</span>; 
    <span class="hljs-keyword">bool</span> hasRoad &lt;- <span class="hljs-keyword">false</span> update: place . road &gt; <span class="hljs-number">0.05</span>;
    
    <span class="hljs-comment">//Reflex to diffuse pheromon on the cell once the agent has food</span>
    reflex diffuse_road when:hasFood=<span class="hljs-keyword">true</span>{
      ant_grid(location).road &lt;- ant_grid(location).road + <span class="hljs-number">100.0</span>;
   }
    <span class="hljs-comment">//Reflex to wander while the ant has no food</span>
    reflex wandering when: ( ! hasFood ) <span class="hljs-keyword">and</span> ( ! hasRoad ) <span class="hljs-keyword">and</span> ( place . food = <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">do</span> wander amplitude: <span class="hljs-number">120</span> speed: <span class="hljs-number">1.0</span>;
    }
    <span class="hljs-comment">//Reflex to search food when the agent has no food nor pheromon road close</span>
    reflex looking when: ( ! hasFood ) <span class="hljs-keyword">and</span> ( hasRoad ) <span class="hljs-keyword">and</span> ( place . food = <span class="hljs-number">0</span> ) { 
        <span class="hljs-keyword">list</span>&lt;ant_grid&gt; list_places &lt;- place . neighbours;
        ant_grid goal &lt;- list_places first_with ( each . food &gt; <span class="hljs-number">0</span> );
        <span class="hljs-keyword">if</span> goal != nil {
            location &lt;- goal.location ; 
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">int</span> min_nest &lt;- ( list_places min_of ( each . nest ) );
            list_places &lt;- list_places sort ( ( each . nest = min_nest ) ? each . road : <span class="hljs-number">0.0</span> ) ;
            location &lt;- point ( last ( list_places ) ) ;
        }
    }
    <span class="hljs-comment">//Reflex to take food</span>
    reflex taking when: ( ! hasFood ) <span class="hljs-keyword">and</span> ( place . food &gt; <span class="hljs-number">0</span> ) { 
        hasFood &lt;- <span class="hljs-keyword">true</span> ;
        place . food &lt;- place . food - <span class="hljs-number">1</span> ;
    }
    <span class="hljs-comment">//Reflex to make the ant return to the nest once it has food</span>
    reflex homing when: ( hasFood ) <span class="hljs-keyword">and</span> ( ! place . isNestLocation ) {
        <span class="hljs-keyword">do</span> <span class="hljs-keyword">goto</span> target:center  speed:<span class="hljs-number">1.0</span>;
    }
    <span class="hljs-comment">//Reflex to drop food once the ant arrived at the nest</span>
    reflex dropping when: ( hasFood ) <span class="hljs-keyword">and</span> ( place . isNestLocation ) {
        hasFood &lt;- <span class="hljs-keyword">false</span> ;
        heading &lt;- heading - <span class="hljs-number">180</span> ;
    }
    aspect <span class="hljs-keyword">default</span> {
        draw circle(<span class="hljs-number">2.0</span>) color: color;
    }
    
}
<span class="hljs-comment">//Experiment simple to display ant and have user interaction</span>
experiment Simple type:gui {
    parameter <span class="hljs-string">'Evaporation:'</span> <span class="hljs-keyword">var</span>: evaporation_per_cycle;
    parameter <span class="hljs-string">'Diffusion Rate:'</span> <span class="hljs-keyword">var</span>: diffusion_rate;
    output { 
        display Ants refresh: every(<span class="hljs-number">2</span>) { 
            grid ant_grid;
            species ant aspect: <span class="hljs-keyword">default</span>;
            graphics <span class="hljs-string">'displayText'</span> {
                draw string ( food_remaining ) size: <span class="hljs-number">24.0</span> at: { <span class="hljs-number">20</span> , <span class="hljs-number">20</span> } color: rgb ( <span class="hljs-string">'white'</span> );
            }
            <span class="hljs-comment">//Event triggering the action passed in parameter</span>
            event mouse_down action:press;
            event mouse_up action:release;
        }  
        display Ants_2 refresh: every(<span class="hljs-number">2</span>) { 
            grid ant_grid;
            graphics <span class="hljs-string">'displayText'</span> {
                draw string ( food_remaining ) size: <span class="hljs-number">24.0</span> at: { <span class="hljs-number">20</span> , <span class="hljs-number">20</span> } color: rgb ( <span class="hljs-string">'white'</span> );
            }
            event mouse_down action:press;
            event mouse_up action:click2;
        }  
    }
}

<span class="hljs-comment">// This experiment explores two parameters with an exhaustive strategy, </span>
<span class="hljs-comment">// repeating each simulation two times, in order to find the best combination </span>
<span class="hljs-comment">// of parameters to minimize the time taken by ants to gather all the food</span>
experiment <span class="hljs-string">'Exhaustive optimization'</span> type: batch repeat: <span class="hljs-number">2</span> keep_seed: <span class="hljs-keyword">true</span> until: ( food_remaining = <span class="hljs-number">0</span> ) <span class="hljs-keyword">or</span> ( time &gt; <span class="hljs-number">400</span> ) {
    parameter <span class="hljs-string">'Evaporation'</span> <span class="hljs-keyword">var</span>: evaporation_per_cycle among: [ <span class="hljs-number">0.1</span> , <span class="hljs-number">1.0</span> , <span class="hljs-number">2.0</span> , <span class="hljs-number">5.0</span> ,  <span class="hljs-number">10.0</span> ];
    parameter <span class="hljs-string">'Diffusion rate'</span> <span class="hljs-keyword">var</span>: diffusion_rate min: <span class="hljs-number">0.1</span> max: <span class="hljs-number">1.0</span> step:
    <span class="hljs-number">0.3</span>;
    method exhaustive minimize: time;
}

<span class="hljs-comment">// This experiment simply explores two parameters with an exhaustive strategy, </span>
<span class="hljs-comment">// repeating each simulation two times</span>
experiment Repeated type: batch repeat: <span class="hljs-number">2</span> keep_seed: <span class="hljs-keyword">true</span> until: (
food_remaining = <span class="hljs-number">0</span> ) <span class="hljs-keyword">or</span> ( time &gt; <span class="hljs-number">400</span> ) {
    parameter <span class="hljs-string">'Evaporation'</span> <span class="hljs-keyword">var</span>: evaporation_per_cycle among: [ <span class="hljs-number">0.1</span> , <span class="hljs-number">1.0</span> , <span class="hljs-number">2.0</span> , <span class="hljs-number">5.0</span> ,  <span class="hljs-number">10.0</span> ];
    parameter <span class="hljs-string">'Diffusion rate'</span> <span class="hljs-keyword">var</span>: diffusion_rate min: <span class="hljs-number">0.1</span> max: <span class="hljs-number">1.0</span> step:<span class="hljs-number">0.3</span>;
}

<span class="hljs-comment">// This experiment explores two parameters with a GA strategy, </span>
<span class="hljs-comment">// repeating each simulation two times, in order to find the best combination </span>
<span class="hljs-comment">// of parameters to minimize the time taken by ants to gather all the food </span>
experiment Genetic type: batch keep_seed: <span class="hljs-keyword">true</span> repeat: <span class="hljs-number">3</span> until: ( food_remaining
= <span class="hljs-number">0</span> ) <span class="hljs-keyword">or</span> ( time &gt; <span class="hljs-number">400</span> ) {
    parameter <span class="hljs-string">'Evaporation'</span> <span class="hljs-keyword">var</span>: evaporation_per_cycle min: <span class="hljs-number">0.05</span> max: <span class="hljs-number">10.0</span>
    step: <span class="hljs-number">0.1</span>;
    parameter <span class="hljs-string">'Diffusion rate'</span> <span class="hljs-keyword">var</span>: diffusion_rate min: <span class="hljs-number">0.0</span> max: <span class="hljs-number">1.0</span> step:
    <span class="hljs-number">0.01</span>;
    method genetic pop_dim: <span class="hljs-number">5</span> crossover_prob: <span class="hljs-number">0.7</span> mutation_prob: <span class="hljs-number">0.1</span>
    nb_prelim_gen: <span class="hljs-number">1</span> max_gen: <span class="hljs-number">20</span> minimize: time;
}
</code></pre>
<script>hljs.initHighlightingOnLoad();</script></body></html>