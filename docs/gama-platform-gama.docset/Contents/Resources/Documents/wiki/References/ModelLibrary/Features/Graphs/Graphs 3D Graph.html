<html><!-- Online page at https://github.com/gama-platform/gama/wiki/References/ModelLibrary/Features/Graphs/Graphs 3D Graph --><head><meta charset="utf-8"><title>Graphs 3D Graph</title><script src="../../../../../dash_resources/highlight.all.js"></script><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/github-markdown.css"><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/highlightjs.github.css"></head><body class="markdown-body" style="padding-bottom:20px; margin: 8px 13px;"><h1 id="graphs-3d-graph">Graphs 3D Graph</h1>
<h1 id="3d-graph">3D Graph</h1>
<p><em>Author : Arnaud Grignard</em></p>
<p>Model using a 3D Graph and updating it at each step according to the location and the degree of each sphere. An arc is created between two adjacent spheres. Two different experiments are proposed : one with a dynamic size for the spheres according to their degree, one simpler with no update of the size.</p>
<p>Code of the model : </p>
<pre><code class="hljs http">  

<span class="groovy">model graph3D

global {
    <span class="hljs-keyword">int</span> number_of_agents <span class="hljs-string">parameter:</span> <span class="hljs-string">'Number of Agents'</span> <span class="hljs-string">min:</span> <span class="hljs-number">1</span> &lt;- <span class="hljs-number">200</span> <span class="hljs-string">category:</span> <span class="hljs-string">'Initialization'</span>;
    <span class="hljs-keyword">int</span> width_and_height_of_environment <span class="hljs-string">parameter:</span> <span class="hljs-string">'Dimensions'</span> <span class="hljs-string">min:</span> <span class="hljs-number">100</span> &lt;- <span class="hljs-number">500</span> <span class="hljs-string">category:</span> <span class="hljs-string">'Initialization'</span>;
    
    <span class="hljs-comment">//Distance to know if a sphere is adjacent or not with an other</span>
    <span class="hljs-keyword">int</span> distance <span class="hljs-string">parameter:</span> <span class="hljs-string">'distance '</span> <span class="hljs-string">min:</span> <span class="hljs-number">1</span> &lt;- <span class="hljs-number">100</span>;
    
    
    <span class="hljs-keyword">int</span> degreeMax &lt;- <span class="hljs-number">1</span>;
    geometry shape &lt;- cube(width_and_height_of_environment);
    
    
    graph my_graph;
    init {
        
        <span class="hljs-comment">//creation of the node agent ie the spheres with a random location in the environment</span>
        create node_agent <span class="hljs-string">number:</span> number_of_agents {
            location &lt;- { rnd(width_and_height_of_environment), rnd(width_and_height_of_environment), rnd(width_and_height_of_environment) };
        }
        
        do degreeMax_computation;
        
        ask node_agent {
            do compute_degree;
        }
    }
    
    reflex updateDegreeMax {
        do degreeMax_computation;
    }

    action degreeMax_computation {
        my_graph &lt;- node_agent as_distance_graph(distance);
        degreeMax &lt;- <span class="hljs-number">1</span>;
        ask node_agent {
            <span class="hljs-keyword">if</span> ((my_graph) degree_of (self) &gt; degreeMax) {
                degreeMax &lt;- (my_graph) degree_of (self);
            }
        }
    }
}


species node_agent <span class="hljs-string">skills:</span> [moving3D] {
    <span class="hljs-keyword">int</span> degree;
    <span class="hljs-keyword">float</span> radius;
    rgb color ;
    <span class="hljs-keyword">float</span> speed &lt;- <span class="hljs-number">5.0</span>;
    reflex move {
        <span class="hljs-comment">//make the agent move randomly</span>
        do wander;
        <span class="hljs-comment">//compute the degree of the agent</span>
        do compute_degree;
    }
    
    
    action compute_degree {
        degree &lt;- my_graph = nil ? 0 : (my_graph) degree_of (self);
        radius &lt;- ((((degree + <span class="hljs-number">1</span>) ^ <span class="hljs-number">1.4</span>) / (degreeMax))) * <span class="hljs-number">5</span>;
        color &lt;- hsb(<span class="hljs-number">0.66</span>,degree / (degreeMax + <span class="hljs-number">1</span>), <span class="hljs-number">0.5</span>);
    }

    aspect base {
        draw sphere(<span class="hljs-number">10</span>) <span class="hljs-string">color:</span>°black;
    }
    
    aspect dynamic {
        draw sphere(radius) <span class="hljs-string">color:</span> color;
    }

}

experiment Display <span class="hljs-string">type:</span> gui {
    output {
        display WanderingSphere <span class="hljs-string">type:</span> opengl { 
            species node_agent <span class="hljs-string">aspect:</span> dynamic;
            graphics <span class="hljs-string">"edges"</span> {
                <span class="hljs-comment">//Creation of the edges of adjacence</span>
                <span class="hljs-keyword">if</span> (my_graph != nil) {
                    loop eg <span class="hljs-string">over:</span> my_graph.edges {
                        geometry edge_geom &lt;- geometry(eg);
                        <span class="hljs-keyword">float</span> val &lt;- <span class="hljs-number">255</span> * edge_geom.perimeter / distance; 
                        draw line(edge_geom.points, <span class="hljs-number">0.5</span>)  <span class="hljs-string">color:</span> rgb(val,val,val);
                    }
                }
                
            }
        }
    }
}


experiment SimpleDisplay <span class="hljs-string">type:</span> gui {
    output {
        display WanderingSphere <span class="hljs-string">type:</span> opengl { 
            species node_agent <span class="hljs-string">aspect:</span> base;
            graphics <span class="hljs-string">"edges"</span> {
                <span class="hljs-keyword">if</span> (my_graph != nil) {
                    loop eg <span class="hljs-string">over:</span> my_graph.edges {
                        geometry edge_geom &lt;- geometry(eg);
                        <span class="hljs-keyword">float</span> val &lt;- <span class="hljs-number">255</span> * edge_geom.perimeter / distance; 
                        draw line(edge_geom.points) <span class="hljs-string">color:</span>°black;
                    }
                }
                
            }
        }
    }
}
</span></code></pre>
<script>hljs.initHighlightingOnLoad();</script></body></html>