<html><!-- Online page at https://github.com/gama-platform/gama/wiki/References/ModelLibrary/Toy Models/Articles/Articles Prima_model2 --><head><meta charset="utf-8"><title>Articles Prima_model2</title><script src="../../../../../dash_resources/highlight.all.js"></script><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/github-markdown.css"><link rel="stylesheet" type="text/css" href="../../../../../dash_resources/highlightjs.github.css"></head><body class="markdown-body" style="padding-bottom:20px; margin: 8px 13px;"><h1 id="articles-prima_model2">Articles Prima_model2</h1>
<h1 id="prima-2">Prima 2</h1>
<p>_Author : _</p>
<p>This model shows how to create agent and make them move randomly in the world. Some agents are infected, and others can gain the infection if they are in a certain range. The people are now placed in buildings at the initial state. Those buildings are created thanks to a shapefile. Roads are also created thanks to an other shapefile.</p>
<p>Code of the model : </p>
<pre><code class="hljs processing">model model2 
 
global {
    <span class="hljs-comment">//Shapefile for the roads</span>
    file roads_shapefile &lt;- file(<span class="hljs-string">"../includes/road.shp"</span>);
    <span class="hljs-comment">//Shapefile for the buildings</span>
    file buildings_shapefile &lt;- file(<span class="hljs-string">"../includes/building.shp"</span>);
    <span class="hljs-comment">//Definition of the shape as the bounds of the roads shapefile</span>
    geometry <span class="hljs-built_in">shape</span> &lt;- envelope(roads_shapefile);
    init {
        <span class="hljs-comment">//Creation of the road agents using the shapefile</span>
        create roads from: roads_shapefile;
        <span class="hljs-comment">//Creation of the building agents using the shapefile</span>
        create buildings from: buildings_shapefile;
        <span class="hljs-comment">//Creation of the people agent and place them in one of the building and chose a target in the building agents</span>
        create people number:<span class="hljs-number">1000</span> {
            location &lt;- any_location_in(one_of(buildings));
            target &lt;- any_location_in(one_of(buildings));
        }
    }
}

<span class="hljs-comment">//People species with agents moving and can be infected</span>
species people skills:[moving]{     
    <span class="hljs-built_in">float</span> speed &lt;- <span class="hljs-number">5.0</span> + rnd(<span class="hljs-number">5</span>);
    bool is_infected &lt;- flip(<span class="hljs-number">0.01</span>);
    <span class="hljs-built_in">point</span> target;
    <span class="hljs-comment">//Make the agent wander at each step with a certain speed.</span>
    reflex move {
        do wander;
    }
    <span class="hljs-comment">//Infect the agent if it is not already infected, and according to the infected people in a range</span>
    reflex infect when: is_infected{
        ask people at_distance <span class="hljs-number">10</span> {
            <span class="hljs-keyword">if</span> flip(<span class="hljs-number">0.01</span>) {
                is_infected &lt;- <span class="hljs-keyword">true</span>;
            }
        }
    }
    aspect circle{
        <span class="hljs-title">draw</span> circle(<span class="hljs-number">5</span>) <span class="hljs-built_in">color</span>:is_infected ? #<span class="hljs-built_in">red</span> : #<span class="hljs-built_in">green</span>;
    }
}

species roads {
    aspect geom {
        <span class="hljs-title">draw</span> <span class="hljs-built_in">shape</span> <span class="hljs-built_in">color</span>: #black;
    }
}

species buildings {
    aspect geom {
        <span class="hljs-title">draw</span> <span class="hljs-built_in">shape</span> <span class="hljs-built_in">color</span>: #gray;
    }
}

experiment main_experiment type:gui{
    output {
        display <span class="hljs-built_in">map</span> {
            species roads aspect:geom;
            species buildings aspect:geom;
            species people aspect:circle;           
        }
    }
}
</code></pre>
<script>hljs.initHighlightingOnLoad();</script></body></html>