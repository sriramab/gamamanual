<html><!-- Online page at https://github.com/gama-platform/gama/wiki/GoldMinerModel_step1 --><head><meta charset="utf-8"><title>GoldMinerModel_step1</title><script src="../dash_resources/highlight.all.js"></script><link rel="stylesheet" type="text/css" href="../dash_resources/github-markdown.css"><link rel="stylesheet" type="text/css" href="../dash_resources/highlightjs.github.css"></head><body class="markdown-body" style="padding-bottom:20px; margin: 8px 13px;"><h1 id="goldminermodel_step1">GoldMinerModel_step1</h1>
<a class="dashAnchor" name="//apple_ref/Section/1.%20Skeleton%20model"></a><h1 id="1-skeleton-model">1. Skeleton model</h1>
<p>This first step consists in defining the skeleton model with the gold mines and the gold market.</p>
<a class="dashAnchor" name="//apple_ref/Section/Formulation"></a><h2 id="formulation">Formulation</h2>
<ul>
<li>Definition of the gold mine species
<ul>
<li>Definition of the market species</li>
<li>Creation of the gold mine and market agents</li>
<li>Definition of a display with the gold mines and the market</li>
</ul>
</li>
</ul>
<a class="dashAnchor" name="//apple_ref/Section/Model%20Definition"></a><h2 id="model-definition">Model Definition</h2>
<a class="dashAnchor" name="//apple_ref/Section/species"></a><h3 id="species">species</h3>
<p>In this first model, we have to define two species of agents: the <strong>goldmine</strong> agents and the <strong>market</strong> ones. These agents will not have a particular behavior, they will just be displayed.
For the goldmine species, we define a new attribute: <strong>quantity</strong> of type <em>int</em>, with for initial value a random integer between 0 and 20. We also define aspect called <strong>default</strong> that displays the goldmine as a triangle with a gray color if the gold mine is empty, yellow otherwise. The size of the triangle depends on the quantity of gold nuggets in the mine. 
Concerning the market species, we define a new attribute: <strong>golds</strong> of type <em>int</em>. We define as well an aspect called <strong>default</strong> that displays the market as a blue square.</p>
<pre><code class="hljs processing">species goldmine {
    <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> quantity &lt;- rnd(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">20</span></span>);
    aspect <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>
    {
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (quantity = <span class="hljs-number"><span class="hljs-number">0</span></span>) {
            <span class="hljs-title"><span class="hljs-title">draw</span></span> <span class="hljs-built_in"><span class="hljs-built_in">triangle</span></span>(<span class="hljs-number"><span class="hljs-number">200</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">color</span></span>: #gray border: #black; 
        } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {
            <span class="hljs-title"><span class="hljs-title">draw</span></span> <span class="hljs-built_in"><span class="hljs-built_in">triangle</span></span>(<span class="hljs-number"><span class="hljs-number">200</span></span> + quantity*<span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">color</span></span>: #yellow border: #black; 
        }
     
    }
}

species market {
    <span class="hljs-built_in"><span class="hljs-built_in">int</span></span> golds;
    aspect <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>
    {
      <span class="hljs-title"><span class="hljs-title">draw</span></span> square(<span class="hljs-number"><span class="hljs-number">1000</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">color</span></span>: #black ;
    }
}
</code></pre>
<a class="dashAnchor" name="//apple_ref/Section/global%20variables"></a><h3 id="global-variables">global variables</h3>
<p>We define two global variables for the model: one called <strong>nb_mines</strong> that will be used to define the number of mines and that will be set to 10. One call <strong>the_market</strong> that will represent the market agent (that will be unique). </p>
<p>In addition, we define the duration of a simulation step to 10 minutes, and we define the shape of the environnement by a square with a side size of 20 kilometers.</p>
<pre><code class="hljs nginx"><span class="hljs-section"><span class="hljs-section">global</span></span> {
    <span class="hljs-attribute"><span class="hljs-attribute">int</span></span> nb_mines &lt;- <span class="hljs-number"><span class="hljs-number">10</span></span>; 
    <span class="hljs-attribute"><span class="hljs-attribute">market</span></span> the_market;
    <span class="hljs-attribute"><span class="hljs-attribute">float</span></span> step &lt;- <span class="hljs-number"><span class="hljs-number">10</span></span><span class="hljs-comment"><span class="hljs-comment">#mn;</span></span>
    geometry shape &lt;- square(<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-comment"><span class="hljs-comment">#km);</span></span>
}
</code></pre>
<a class="dashAnchor" name="//apple_ref/Section/global%20init"></a><h3 id="global-init">global init</h3>
<p>At the initialisation of the model, we create a market agent and <em>nb_mines</em> goldmine agents. For the market agent, we set the value of the <em>the_market</em> agent with the created agent. </p>
<pre><code class="hljs puppet"><span class="hljs-keyword"><span class="hljs-keyword">global</span></span> {
   ...
   init
    {
        create market {
            the_market &lt;- self;
        }
        <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">goldmine</span></span> <span class="hljs-keyword"><span class="hljs-keyword">number</span></span>:nb_mines;
    }
}
</code></pre>
<a class="dashAnchor" name="//apple_ref/Section/display"></a><h3 id="display">display</h3>
<p>We define a display to visualize the market and goldmine agents. We use for that the classic <strong>species</strong> keyword. In order to optimize the display we use an opengl display (facet <strong>type: opengl</strong>).</p>
<p>In the <strong>experiment</strong> block:</p>
<pre><code class="hljs nginx"><span class="hljs-section"><span class="hljs-section">output</span></span> {
   <span class="hljs-attribute"><span class="hljs-attribute">display</span></span> map type: opengl {
    <span class="hljs-attribute"><span class="hljs-attribute">species</span></span> market ;
    <span class="hljs-attribute"><span class="hljs-attribute">species</span></span> goldmine ;
   }
}
</code></pre>
<a class="dashAnchor" name="//apple_ref/Section/Complete%20Model"></a><h2 id="complete-model">Complete Model</h2>
<pre><code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">model</span></span> GoldBdi

global {
    <span class="hljs-attribute"><span class="hljs-attribute">int</span></span> nb_mines &lt;- <span class="hljs-number"><span class="hljs-number">10</span></span>; 
    <span class="hljs-attribute"><span class="hljs-attribute">market</span></span> the_market;
    <span class="hljs-attribute"><span class="hljs-attribute">float</span></span> step &lt;- <span class="hljs-number"><span class="hljs-number">10</span></span><span class="hljs-comment"><span class="hljs-comment">#mn;</span></span>
    
    geometry shape &lt;- square(<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-comment"><span class="hljs-comment">#km);</span></span>
    
    init
    {
        <span class="hljs-attribute"><span class="hljs-attribute">create</span></span> market {
            <span class="hljs-attribute"><span class="hljs-attribute">the_market</span></span> &lt;- self;
        }
        <span class="hljs-attribute"><span class="hljs-attribute">create</span></span> goldmine number:nb_mines;
    }
}

<span class="hljs-attribute"><span class="hljs-attribute">species</span></span> goldmine {
    <span class="hljs-attribute"><span class="hljs-attribute">int</span></span> quantity &lt;- rnd(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">20</span></span>);
    <span class="hljs-attribute"><span class="hljs-attribute">aspect</span></span> default
    {
        <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (quantity = <span class="hljs-number"><span class="hljs-number">0</span></span>) {
            <span class="hljs-attribute"><span class="hljs-attribute">draw</span></span> triangle(<span class="hljs-number"><span class="hljs-number">200</span></span>) color: <span class="hljs-comment"><span class="hljs-comment">#gray border: #black; </span></span>
        } else {
            <span class="hljs-attribute"><span class="hljs-attribute">draw</span></span> triangle(<span class="hljs-number"><span class="hljs-number">200</span></span> + quantity*<span class="hljs-number"><span class="hljs-number">50</span></span>) color: <span class="hljs-comment"><span class="hljs-comment">#yellow border: #black; </span></span>
        }
     
    }
}

species market {
    <span class="hljs-attribute"><span class="hljs-attribute">int</span></span> golds;
    <span class="hljs-attribute"><span class="hljs-attribute">aspect</span></span> default
    {
      <span class="hljs-attribute"><span class="hljs-attribute">draw</span></span> square(<span class="hljs-number"><span class="hljs-number">1000</span></span>) color: <span class="hljs-comment"><span class="hljs-comment">#black ;</span></span>
    }
}

experiment GoldBdi type: gui {

    <span class="hljs-section"><span class="hljs-section">output</span></span> {
        <span class="hljs-attribute"><span class="hljs-attribute">display</span></span> map type: opengl
        {
            <span class="hljs-attribute"><span class="hljs-attribute">species</span></span> market ;
            <span class="hljs-attribute"><span class="hljs-attribute">species</span></span> goldmine ;
        }
    }
}
</code></pre>
<p><a href="BDIAgents.html">Back to the start of the tutorial</a></p>
<ol>
<li><a href="GoldMinerModel_step2.html">Definition of the BDI miners</a>
<ol>
<li><a href="GoldMinerModel_step3.html">Definition of social relations between miners</a></li>
<li><a href="GoldMinerModel_step4.html">Use of emotions and personality for the miners</a></li>
<li><a href="GoldMinerModel_step5.html">Adding norms, obligations and enforcement</a></li>
</ol>
</li>
</ol>
<script>hljs.initHighlightingOnLoad();</script></body></html>